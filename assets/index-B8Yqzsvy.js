const __vite__fileDeps=["assets/index-Dqpg2LPM.js","assets/index-B0Zwk6Q1.js","assets/tinymce-rRFwJXCQ.js","assets/index-BTOZHIDb.css","assets/el-link-BOlFR7ca.js","assets/el-link-KCNjwq80.css","assets/close-CVbEjODa.js","assets/el-popper-CCTNlIEI.js","assets/el-popper-Dp4T8EOK.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/index-COM49aMq.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as K,u as b,i as z,s as x,r as H,c as E,a as I,o as O,b as W,f as n,e as G,g as L,h as o,w as r,j as a,k as J,l as C,E as Q,m as X,n as Y,t as Z,p as ee,_ as oe,q as ae,v as te}from"./index-B0Zwk6Q1.js";import{E as se,a as ne}from"./el-form-item-DTlgnzZC.js";import{E as le}from"./el-checkbox-BJgwWizH.js";import{_ as ie,a as re}from"./lock-u0-8KvuJ.js";import{_ as ce,a as pe}from"./index-BV1wEpyx.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./tinymce-rRFwJXCQ.js";import"./_initCloneObject-CmUWLP5I.js";import"./el-switch-B0Iw9EBe.js";const me={class:"v100 flex ac"},_e={class:"qv-tool flex ac pd-base"},ue={class:"flex jc f1 pr no-evt"},fe=K({__name:"index",setup(ge){const{setLogout:B,staticUser:S}=b(),U=ee(()=>oe(()=>import("./index-Dqpg2LPM.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),{t:l}=z.global,{setToken:T,setDynamicUser:$,userInfo:q,showWelcome:R}=b(),d=x({loginLoading:!1}),t=x({username:"admin",password:"123456",keep:!1,captchaId:"",captchaInfo:""}),D=H({username:[{required:!0,message:E(()=>l("login.请输入账号"))}],password:[{required:!0,message:E(()=>l("login.请输入密码"))}]}),f=I(),g=I();let h,i,c;const _=async()=>{n.show(l("加载中"));try{await $(!0),S.welcomeHasEnter=!0,q.id&&R()}catch{n.hide()}},w=async(e="",s="")=>{n.show(l("login.登录中")),t.captchaInfo=e,t.captchaId=s;try{const{data:m}=await C("post",t);T(m.userInfo.token),await _()}catch{n.hide()}},y=async()=>{var e;h?(n.hide(),(e=g.value)==null||e.show()):await w()},v=async()=>{try{const{data:e}=await C("get");h=e.captcha,c&&await y(),i="success"}catch(e){e.code===303?(c&&n.hide(),!c&&window.app_entry.split("?redirectPath=")[0]==="/login"?(i=void 0,await _()):Q.confirm(`${e.msg}${l("login.确认将继续登录, 取消将退出登录")}`,l("温馨提示")).then(async()=>{i=void 0,await _()}).catch(async()=>{i="fail",await B(!1)})):(i="fail",n.hide()),c=!1}},k=async()=>{var e;d.loginLoading=!0;try{await((e=f.value)==null?void 0:e.validate()),i!=="success"?(c=!0,n.show(l("login.确认中")),i==="fail"&&await v()):await y()}catch{}d.loginLoading=!1};return O(()=>{v()}),W(()=>{n.hide()}),(e,s)=>{const m=ce,M=pe,F=ie,V=ae,u=ne,N=re,P=le,j=te,A=se;return X(),G("div",me,[L("div",_e,[o(m),o(M,{class:"ml-base"})]),L("div",ue,[o(A,{ref_key:"ref_form",ref:f,rules:a(D),model:a(t),class:"qv-form",size:"large",onKeyup:J(k,["enter"])},{default:r(()=>[o(u,{prop:"username"},{default:r(()=>[o(V,{modelValue:a(t).username,"onUpdate:modelValue":s[0]||(s[0]=p=>a(t).username=p),modelModifiers:{trim:!0},clearable:"",placeholder:e.$t("login.请输入账号"),maxlength:"30"},{prefix:r(()=>[o(F)]),_:1},8,["modelValue","placeholder"])]),_:1}),o(u,{prop:"password"},{default:r(()=>[o(V,{modelValue:a(t).password,"onUpdate:modelValue":s[1]||(s[1]=p=>a(t).password=p),modelModifiers:{trim:!0},type:"password",placeholder:e.$t("login.请输入密码"),"show-password":"",maxlength:"30"},{prefix:r(()=>[o(N)]),_:1},8,["modelValue","placeholder"])]),_:1}),o(P,{modelValue:a(t).keep,"onUpdate:modelValue":s[2]||(s[2]=p=>a(t).keep=p),label:e.$t("login.保持会话")},null,8,["modelValue","label"]),o(u,null,{default:r(()=>[o(j,{round:"",class:"w100",type:"primary","auto-insert-space":"",loading:a(d).loginLoading,onClick:k},{default:r(()=>[Y(Z(e.$t(a(d).loginLoading?"login.登录中":"login.登录")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])]),o(a(U),{ref_key:"ref_tap_captcha",ref:g,onSucceed:w},null,512)])}}}),Ie=de(fe,[["__scopeId","data-v-32e5f8d5"]]);export{Ie as default};
