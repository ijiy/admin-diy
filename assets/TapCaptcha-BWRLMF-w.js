import{w as E,J as F,t as I,v as M}from"./element-plus-DV6F2B4w.js";import{_ as N}from"./close-h8PqKVjB.js";import{d as B,ao as T,o as s,J as x,K as r,G as C,u as a,b as y,P as $,ae as q,c as l,a as A,bK as H,S as b,Q as R,R as f,ag as V,M as J,L as K,a1 as U,_ as G}from"./@vue-CMlG33N7.js";import{i as P,g as Q,f as X,p as D,h as Y}from"./index-D6CaSJEW.js";import{_ as O}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./lodash-es-ByZL8CPd.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-BLWlpg6_.js";import"./@element-plus-C3PuTle3.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-BrgXCphJ.js";import"./vue-demi-Dq6ymT-8.js";import"./@codemirror-D1iYbWyp.js";import"./@lezer-g9ZlY1HQ.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./vue-router-VFlIWpXA.js";import"./vue-i18n-BfQ-3HNT.js";import"./@intlify-DA-PR7LD.js";import"./vue-BI8I7hOi.js";import"./pinia-plugin-persistedstate-DEhZ7rAI.js";import"./destr-CVtkxrq9.js";import"./deep-pick-omit-DyxInw53.js";const W=B({__name:"index",props:{showClose:{type:Boolean,default:!1}},emits:["closed"],setup(u,{expose:c,emit:g}){const w=u,m=g,n=T({isShow:!1});return c({hide:()=>{n.isShow=!1},show:()=>{n.isShow=!0}}),(h,o)=>{const k=N,v=E,e=F;return s(),x(e,{modelValue:a(n).isShow,"onUpdate:modelValue":o[1]||(o[1]=i=>a(n).isShow=i),draggable:"","align-center":"",class:"global-dialog","show-close":!1,onClosed:o[2]||(o[2]=i=>m("closed"))},{header:r(()=>[C(h.$slots,"header")]),footer:r(()=>[C(h.$slots,"footer")]),default:r(()=>[w.showClose?(s(),x(v,{key:0,underline:!1,class:"ani-rotate-icon",onClick:o[0]||(o[0]=i=>a(n).isShow=!1)},{default:r(()=>[y(k)]),_:1})):$("",!0),C(h.$slots,"default")]),_:3},8,["modelValue"])}}}),Z={class:"icon-base",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"};function tt(u,c){return s(),l("svg",Z,c[0]||(c[0]=[A("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)]))}const et=q({name:"ep-refresh",render:tt}),ot={key:1,class:"flex ac jc g-half"},st={class:"qv-box no-select pr"},at=["src"],it=["onClick"],lt=B({__name:"TapCaptcha",emits:["succeed"],setup(u,{expose:c,emit:g}){const w=g,{t:m}=P.global,n=H("ref_dialog"),t=T({loading:!1,dots:[],tip:"",id:"",text:"",base64:""}),_=async()=>{if(!t.loading){t.loading=!0;try{const{data:e}=await Q(X("captcha"));t.dots=[],t.id=e.id,t.text=e.text,t.base64=e.base64}catch{}t.tip="",t.loading=!1}},h=()=>{var e;_(),(e=n.value)==null||e.show()};let o;const k=e=>{o=[...t.dots],o.splice(e,1),t.dots=o},v=async e=>{if(t.dots.length<t.text.length&&(o=[...t.dots],o.push(`${e.offsetX},${e.offsetY}`),t.dots=o,t.dots.length===t.text.length)){const i=[t.dots.join("-"),e.target.width,e.target.height].join(";");D.show(m("login.确认中"));try{await Y(t.id,i),t.tip=m("login.验证成功"),w("succeed",i,t.id)}catch{t.tip=m("login.验证失败"),setTimeout(()=>{_()},500),D.hide()}}};return c({show:h}),(e,i)=>{const S=et,L=I,j=W,z=M;return s(),x(j,{ref:"ref_dialog"},{header:r(()=>[a(t).tip?(s(),l(b,{key:0},[R(f(a(t).tip),1)],64)):a(t).text?(s(),l("div",ot,[R(f(e.$t("login.请依次点击"))+" ",1),(s(!0),l(b,null,V(a(t).text,(p,d)=>(s(),l("span",{key:d,class:J(["qv-text fb",a(t).dots.length>d?"is-active":""])},f(p),3))),128)),y(L,{content:"刷新",placement:"top"},{default:r(()=>[y(S,{class:"cp",onClick:_})]),_:1})])):$("",!0)]),default:r(()=>[K((s(),l("div",st,[a(t).base64?(s(),l("img",{key:0,class:"h100",src:a(t).base64,alt:"加载中",onClick:i[0]||(i[0]=U(p=>v(p),["prevent"]))},null,8,at)):$("",!0),(s(!0),l(b,null,V(a(t).dots,(p,d)=>(s(),l("div",{key:d,class:"qv-dot fb cp flex ac jc",style:G(`left: ${parseFloat(p.split(",")[0])-10}px; top: ${parseFloat(p.split(",")[1])-10}px;`),onClick:nt=>k(d)},f(d+1),13,it))),128))])),[[z,a(t).loading]])]),_:1},512)}}}),zt=O(lt,[["__scopeId","data-v-75497eeb"]]);export{zt as default};
