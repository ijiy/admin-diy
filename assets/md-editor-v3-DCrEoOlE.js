import{k as it,x as gn,M as hn,u as vn,U as tt,I as pn,C as bn,$ as yn}from"./@vavt-D0iSl322.js";import{d as V,i as A,b as d,X as ee,r as R,w as _,k as U,C as Ce,a3 as lt,s as ge,B as J,n as ue,a6 as kn,ac as wn,F as re,S as Ue,V as ce,A as Cn}from"./@vue-CMlG33N7.js";import{E as de,H as Pl,s as Nl,k as $n,h as nl,m as Tn,d as Sn,u as xn,r as En,a as An,b as Ye,i as _n,p as In,c as ke,C as be,e as Ln,f as Hn,g as Fn,l as Rn,S as Mn,j as Pn,n as Nn}from"./@codemirror-D1iYbWyp.js";import{a as C}from"./@lezer-g9ZlY1HQ.js";import{m as On}from"./medium-zoom-bWEtUbjf.js";import{c as Bn}from"./copy-to-clipboard-D5Xq7YMv.js";import{M as Dn}from"./markdown-it-DI8MEbma.js";import{r as jn}from"./markdown-it-image-figures-BD49Kf-b.js";import{s as Vn}from"./markdown-it-sub-Bxi31R0z.js";import{s as Wn}from"./markdown-it-sup-Bp2DoVCN.js";import{L as Un}from"./lru-cache-DmfXgoGS.js";const s="md-editor",zn="https://at.alicdn.com/t/c/font_2605852_cmafimm6hot.js",Gn="https://at.alicdn.com/t/c/font_2605852_cmafimm6hot.css",O="https://cdnjs.cloudflare.com/ajax/libs",qn=`${O}/highlight.js/11.10.0/highlight.min.js`,ol={main:`${O}/prettier/2.8.0/standalone.js`,markdown:`${O}/prettier/2.8.0/parser-markdown.js`},Xn={css:`${O}/cropperjs/1.5.13/cropper.min.css`,js:`${O}/cropperjs/1.5.13/cropper.min.js`},Kn=`${O}/screenfull.js/5.2.0/screenfull.min.js`,Ol=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","previewOnly","htmlPreview","catalog","github"],Bl=["markdownTotal","=","scrollSwitch"],al={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",previewOnly:"仅预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",previewOnly:"preview only",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},Yn=`${O}/mermaid/10.6.1/mermaid.esm.min.mjs`,Zn={js:`${O}/KaTeX/0.16.9/katex.min.js`,css:`${O}/KaTeX/0.16.9/katex.min.css`},nt={a11y:{light:`${O}/highlight.js/11.10.0/styles/a11y-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/a11y-dark.min.css`},atom:{light:`${O}/highlight.js/11.10.0/styles/atom-one-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/atom-one-dark.min.css`},github:{light:`${O}/highlight.js/11.10.0/styles/github.min.css`,dark:`${O}/highlight.js/11.10.0/styles/github-dark.min.css`},gradient:{light:`${O}/highlight.js/11.10.0/styles/gradient-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/gradient-dark.min.css`},kimbie:{light:`${O}/highlight.js/11.10.0/styles/kimbie-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/kimbie-dark.min.css`},paraiso:{light:`${O}/highlight.js/11.10.0/styles/paraiso-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${O}/highlight.js/11.10.0/styles/qtcreator-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${O}/highlight.js/11.10.0/styles/stackoverflow-light.min.css`,dark:`${O}/highlight.js/11.10.0/styles/stackoverflow-dark.min.css`}},G={editorExtensions:{highlight:{js:qn,css:nt},prettier:{standaloneJs:ol.main,parserMarkdownJs:ol.markdown},cropper:{...Xn},iconfont:zn,iconfontClass:Gn,screenfull:{js:Kn},mermaid:{js:Yn},katex:{...Zn}},editorExtensionsAttrs:{},editorConfig:{languageUserDefined:{},mermaidTemplate:{},renderDelay:500,zIndex:2e4},codeMirrorExtensions:(e,l)=>l,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg",mermaidConfig:e=>e,katexConfig:e=>e},_e=170,se=({instance:e,ctx:l,props:t={}},n="default")=>{const o=(e==null?void 0:e.$slots[n])||(l==null?void 0:l.slots[n]);return(o?o(e):"")||t[n]},Jn={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},ye=V({props:Jn,setup(e,l){const t=`${s}-dropdown-hidden`,n=ee({overlayClass:[t],overlayStyle:{},triggerHover:!1,overlayHover:!1}),o=R(),a=R(),c=()=>{var r,u;n.triggerHover=!0;const g=o.value,h=a.value;if(!g||!h)return;const v=g.getBoundingClientRect(),y=g.offsetTop,p=g.offsetLeft,k=v.height,b=v.width,w=g.getRootNode(),T=((r=w.querySelector(e.relative))==null?void 0:r.scrollLeft)||0,S=((u=w.querySelector(e.relative))==null?void 0:u.clientWidth)||0;let x=p-h.offsetWidth/2+b/2-T;x+h.offsetWidth>T+S&&(x=T+S-h.offsetWidth),x<0&&(x=0),n.overlayStyle={...n.overlayStyle,top:y+k+"px",left:x+"px"},e.onChange(!0)},f=()=>{n.overlayHover=!0};_(()=>e.visible,r=>{r?n.overlayClass=n.overlayClass.filter(u=>u!==t):n.overlayClass.push(t)});let i=-1;const m=r=>{o.value===r.target?n.triggerHover=!1:n.overlayHover=!1,clearTimeout(i),i=window.setTimeout(()=>{!n.overlayHover&&!n.triggerHover&&e.onChange(!1)},10)};return U(()=>{o.value.addEventListener("mouseenter",c),o.value.addEventListener("mouseleave",m),a.value.addEventListener("mouseenter",f),a.value.addEventListener("mouseleave",m)}),Ce(()=>{o.value.removeEventListener("mouseenter",c),o.value.removeEventListener("mouseleave",m),a.value.removeEventListener("mouseenter",f),a.value.removeEventListener("mouseleave",m)}),()=>{const r=se({ctx:l}),u=se({props:e,ctx:l},"overlay"),g=lt(r instanceof Array?r[0]:r,{ref:o,key:"cloned-dropdown-trigger"}),h=d("div",{class:[`${s}-dropdown`,n.overlayClass],style:n.overlayStyle,ref:a},[d("div",{class:`${s}-dropdown-overlay`},[u instanceof Array?u[0]:u])]);return[g,h]}}}),Qn={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},previewTheme:{type:String},default:{type:[String,Object]}},Re=V({name:"DropdownToolbar",props:Qn,emits:["onChange"],setup(e,l){const t=A("editorId");return()=>{const n=se({props:e,ctx:l},"trigger"),o=se({props:e,ctx:l},"overlay"),a=se({props:e,ctx:l});return d(ye,{relative:`#${t}-toolbar-wrapper`,visible:e.visible,onChange:c=>{e.onChange instanceof Function?e.onChange(c):l.emit("onChange",c)},overlay:o},{default:()=>[d("div",{class:`${s}-toolbar-item`,title:e.title||""},[n,a])]})}}});Re.install=e=>(e.component(Re.name,Re),e);var eo=Object.defineProperty,to=(e,l,t)=>l in e?eo(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,lo=(e,l,t)=>to(e,l+"",t);class no{constructor(){lo(this,"pools",{})}remove(l,t,n){const a=this.pools[l]&&this.pools[l][t];a&&(this.pools[l][t]=a.filter(c=>c!==n))}clear(l){this.pools[l]={}}on(l,t){return this.pools[l]||(this.pools[l]={}),this.pools[l][t.name]||(this.pools[l][t.name]=[]),this.pools[l][t.name].push(t.callback),this.pools[l][t.name].includes(t.callback)}emit(l,t,...n){this.pools[l]||(this.pools[l]={});const a=this.pools[l][t];a&&a.forEach(c=>{try{c(...n)}catch(f){console.error(`${t} monitor event exception！`,f)}})}}const $=new no,ze="onSave",st="changeCatalogVisible",Dl="changeFullscreen",rl="pageFullscreenChanged",il="fullscreenChanged",sl="previewChanged",cl="previewOnlyChanged",ul="htmlPreviewChanged",dl="catalogVisibleChanged",Me="buildFinished",he="errorCatcher",P="replace",Ge="uploadImage",ot="openModals",jl="ctrlZ",Vl="ctrlShiftZ",Pe="catalogChanged",Wl="pushCatalog",ct="rerender",Ul="eventListener",zl="taskStateChanged",fl=(e,l)=>{const t=n=>{const o=e.parentElement||document.body,a=o.offsetWidth,c=o.offsetHeight,{clientWidth:f,clientHeight:i}=document.documentElement,m=n.offsetX,r=n.offsetY,u=h=>{let v=h.x+document.body.scrollLeft-document.body.clientLeft-m,y=h.y+document.body.scrollTop-document.body.clientTop-r;v=v<1?1:v<f-a-1?v:f-a-1,y=y<1?1:y<i-c-1?y:i-c-1,l?l(v,y):(o.style.left=`${v}px`,o.style.top=`${y}px`)};document.addEventListener("mousemove",u);const g=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",g)};document.addEventListener("mouseup",g)};return e.addEventListener("mousedown",t),()=>{e.removeEventListener("mousedown",t)}},ne=(e,l,t="")=>{var n;const o=document.getElementById(l.id);if(o)t!==""&&(Reflect.get(window,t)?(n=l.onload)==null||n.call(o,new Event("load")):l.onload&&o.addEventListener("load",l.onload));else{const a={...l};a.onload=null;const c=ao(e,a);l.onload&&c.addEventListener("load",l.onload),document.head.appendChild(c)}},oo=(e,l)=>{const t=document.getElementById(l.id);t==null||t.remove(),ne(e,l)},ao=(e,l)=>{const t=document.createElement(e);return Object.keys(l).forEach(n=>{l[n]!==void 0&&(t[n]=l[n])}),t},ml=(()=>{const e=t=>{if(!t)return;const n=t.firstChild;let o=1,a=0,c=0,f=!1,i,m,r,u=1;const g=()=>{n.style.transform=`translate(${a}px, ${c}px) scale(${o})`};t.addEventListener("touchstart",h=>{h.touches.length===1?(f=!0,i=h.touches[0].clientX-a,m=h.touches[0].clientY-c):h.touches.length===2&&(r=Math.hypot(h.touches[0].clientX-h.touches[1].clientX,h.touches[0].clientY-h.touches[1].clientY),u=o)}),t.addEventListener("touchmove",h=>{if(h.preventDefault(),f&&h.touches.length===1)a=h.touches[0].clientX-i,c=h.touches[0].clientY-m,g();else if(h.touches.length===2){const y=Math.hypot(h.touches[0].clientX-h.touches[1].clientX,h.touches[0].clientY-h.touches[1].clientY)/r,p=o;o=u*(1+(y-1));const k=(h.touches[0].clientX+h.touches[1].clientX)/2,b=(h.touches[0].clientY+h.touches[1].clientY)/2,w=n.getBoundingClientRect(),T=(k-w.left)/p,S=(b-w.top)/p;a-=T*(o-p),c-=S*(o-p),g()}}),t.addEventListener("touchend",()=>{f=!1}),t.addEventListener("wheel",h=>{h.preventDefault();const v=.02,y=o;h.deltaY<0?o+=v:o=Math.max(.1,o-v);const p=n.getBoundingClientRect(),k=h.clientX-p.left,b=h.clientY-p.top;a-=k/y*(o-y),c-=b/y*(o-y),g()}),t.addEventListener("mousedown",h=>{f=!0,i=h.clientX-a,m=h.clientY-c}),t.addEventListener("mousemove",h=>{f&&(a=h.clientX-i,c=h.clientY-m,g())}),t.addEventListener("mouseup",()=>{f=!1}),t.addEventListener("mouseleave",()=>{f=!1})};return t=>{t.forEach(n=>{e(n)})}})(),ro=(e,l="image.png")=>{const t=e.split(","),n=t[0].match(/:(.*?);/);if(n){const o=n[1],a=atob(t[1]);let c=a.length;const f=new Uint8Array(c);for(;c--;)f[c]=a.charCodeAt(c);return new File([f],l,{type:o})}return null},io=(e,l)=>{if(!e)return e;const t=l.split(`
`),n=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{n.push("<span></span>")}),n.push("</span>"),`<span class="${s}-code-block">${e}</span>${n.join("")}`},so=(e,l)=>{if(!e||!l)return 0;const t=e==null?void 0:e.getBoundingClientRect();if(l===document.documentElement)return t.top-l.clientTop;const n=l==null?void 0:l.getBoundingClientRect();return t.top-n.top},co=(()=>{let e=0;return l=>l+ ++e})(),gl=(()=>{let e=0;return()=>++e})(),uo=V({props:{name:{type:String,default:""}},setup(e){return()=>d("svg",{class:`${s}-icon`,"aria-hidden":"true"},[d("use",{"xlink:href":`#${s}-icon-${e.name}`},null)])}}),I=V({props:{name:{type:String,default:""}},setup(e){const l=A("customIcon");return()=>{const t=l.value[e.name];return typeof t=="object"?typeof t.component=="object"?wn(t.component,t.props):d("span",{innerHTML:t.component},null):d(uo,{name:e.name},null)}}}),fo={title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}},class:{type:String},style:{type:[Object,String],default:()=>({})},showMask:{type:Boolean,default:!0}},we=V({name:"MdModal",props:fo,emits:["onClose"],setup(e,l){const t=A("theme"),n=A("rootRef"),o=R(e.visible),a=R([`${s}-modal`]),c=R(),f=R(),i=R(),m=ge();let r=()=>{};const u=ee({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),g=J(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height});_(()=>e.isFullscreen,y=>{y?r():ue(()=>{r=fl(f.value,(p,k)=>{u.initPos.left=p+"px",u.initPos.top=k+"px"})})}),_(()=>e.visible,y=>{y?(u.maskStyle.zIndex=G.editorConfig.zIndex+gl(),u.modalStyle.zIndex=G.editorConfig.zIndex+gl(),a.value.push("zoom-in"),o.value=y,ue(()=>{const p=c.value.offsetWidth/2,k=c.value.offsetHeight/2,b=document.documentElement.clientWidth/2,w=document.documentElement.clientHeight/2;u.initPos.left=b-p+"px",u.initPos.top=w-k+"px",e.isFullscreen||(r=fl(f.value,(T,S)=>{u.initPos.left=T+"px",u.initPos.top=S+"px"}))}),setTimeout(()=>{a.value=a.value.filter(p=>p!=="zoom-in")},140)):(a.value.push("zoom-out"),r(),setTimeout(()=>{a.value=a.value.filter(p=>p!=="zoom-out"),o.value=y},130))});const h=J(()=>({display:o.value?"block":"none"})),v=J(()=>typeof e.style=="string"?[e.style,h.value].join("; "):e.style instanceof Object?{...h.value,...e.style}:h.value);return U(()=>{var y;const p=(y=n.value)==null?void 0:y.getRootNode();i.value=p instanceof Document?document.body:p}),()=>{const y=se({ctx:l}),p=se({props:e,ctx:l},"title");return i.value?d(kn,{to:i.value},{default:()=>[d("div",{ref:m,class:`${s}-modal-container`,"data-theme":t.value},[d("div",{class:e.class,style:v.value},[e.showMask&&d("div",{class:`${s}-modal-mask`,style:u.maskStyle,onClick:()=>{e.onClose?e.onClose():l.emit("onClose")}},null),d("div",{class:a.value,style:{...u.modalStyle,...u.initPos,...g.value},ref:c},[d("div",{class:`${s}-modal-header`,ref:f},[p||""]),d("div",{class:`${s}-modal-body`},[y]),d("div",{class:`${s}-modal-func`},[e.showAdjust&&d("div",{class:`${s}-modal-adjust`,onClick:k=>{k.stopPropagation(),e.isFullscreen?u.initPos=u.historyPos:(u.historyPos=u.initPos,u.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[d(I,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),d("div",{class:`${s}-modal-close`,onClick:k=>{k.stopPropagation(),e.onClose?e.onClose():l.emit("onClose")}},[d(I,{name:"close"},null)])])])])])]}):""}}});we.install=e=>(e.component(we.name,we),e);const mo=`.${s}-preview > [data-line]`,Te=(e,l)=>+getComputedStyle(e).getPropertyValue(l).replace("px",""),go=(e,l)=>{const t=it(()=>{e.removeEventListener("scroll",n),e.addEventListener("scroll",n),l.removeEventListener("scroll",n),l.addEventListener("scroll",n)},50),n=o=>{const a=e.clientHeight,c=l.clientHeight,f=e.scrollHeight,i=l.scrollHeight,m=(f-a)/(i-c);o.target===e?(l.removeEventListener("scroll",n),l.scrollTo({top:e.scrollTop/m}),t()):(e.removeEventListener("scroll",n),e.scrollTo({top:l.scrollTop*m}),t())};return[()=>{t().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",n),l.removeEventListener("scroll",n)}]},ho=(e,l,t)=>{const{view:n}=t,o=gn(),a=k=>n.lineBlockAt(n.state.doc.line(k+1).from).top,c=k=>n.lineBlockAt(n.state.doc.line(k+1).from).bottom;let f=[],i=[],m=[];const r=()=>{f=[],i=Array.from(l.querySelectorAll(mo)),m=i.map(S=>Number(S.dataset.line));const k=[...m],{lines:b}=n.state.doc;let w=k.shift()||0,T=k.shift()||b;for(let S=0;S<b;S++)S===T&&(w=S,T=k.shift()||b),f.push({start:w,end:T-1})},u=(k,b)=>{let w=1;for(let T=i.length-1;T-1>=0;T--){const S=i[T],x=i[T-1];if(S.offsetTop+S.offsetHeight>b&&x.offsetTop<b){w=Number(x.dataset.line);break}}for(let T=f.length-1;T>=0;T--){const S=c(f[T].end),x=a(f[T].start);if(S>k&&x<=k){w=w<f[T].start?w:f[T].start;break}}return w};let g=0,h=0;const v=()=>{var k,b,w;if(h!==0)return!1;g++;const{scrollDOM:T,contentHeight:S}=n;let x=Te(l,"padding-top");const B=n.lineBlockAtHeight(T.scrollTop),{number:L}=n.state.doc.lineAt(B.from),E=f[L-1];if(!E)return!1;let H=1;const N=l.querySelector(`[data-line="${E.start}"]`)||((k=l.firstElementChild)==null?void 0:k.firstElementChild),M=l.querySelector(`[data-line="${E.end+1}"]`)||((b=l.lastElementChild)==null?void 0:b.lastElementChild),z=T.scrollHeight-T.clientHeight,W=l.scrollHeight-l.clientHeight;let K=a(E.start),te=c(E.end),oe=N.offsetTop,q=M.offsetTop-oe;K===0&&(oe=0,N===M?(x=0,te=S-T.offsetHeight,q=W):q=M.offsetTop),H=(T.scrollTop-K)/(te-K);const X=M==((w=l.lastElementChild)==null?void 0:w.lastElementChild)?M.offsetTop+M.clientHeight:M.offsetTop;if(te>=z||X>W){const le=u(z,W);K=a(le),H=(T.scrollTop-K)/(z-K);const Q=l.querySelector(`[data-line="${le}"]`);K>0&&Q&&(oe=Q.offsetTop),q=W-oe+Te(l,"padding-top")}const ae=oe-x+q*H;o(l,ae,()=>{g--})},y=()=>{var k,b,w,T,S,x;if(g!==0)return;h++;const{scrollDOM:B}=n,L=l.scrollTop,E=l.scrollHeight,H=B.scrollHeight-B.clientHeight,N=l.scrollHeight-l.clientHeight;let M=(k=l.firstElementChild)==null?void 0:k.firstElementChild,z=(b=l.firstElementChild)==null?void 0:b.lastElementChild;if(m.length>0){let Q=Math.ceil(m[m.length-1]*(L/E)),j=m.findLastIndex(Y=>Y<=Q);j=j===-1?0:j,Q=m[j];for(let Y=j;Y>=0&&Y<m.length;)if(i[Y].offsetTop>L){if(Y-1>=0){Y--;continue}Q=-1,j=Y;break}else{if(Y+1<m.length&&i[Y+1].offsetTop<L){Y++;continue}Q=m[Y],j=Y;break}switch(j){case-1:{M=(w=l.firstElementChild)==null?void 0:w.firstElementChild,z=i[j];break}case m.length-1:{M=i[j],z=(T=l.firstElementChild)==null?void 0:T.lastElementChild;break}default:M=i[j],z=i[j+1===i.length?j:j+1]}}let W=M===((S=l.firstElementChild)==null?void 0:S.firstElementChild)?0:M.offsetTop-Te(M,"margin-top"),K=z.offsetTop,te=0;const{start:oe,end:q}=f[Number(M.dataset.line||0)];let X=a(oe);const ae=a(q+1===n.state.doc.lines?q:q+1);let le=0;if(ae>H||z.offsetTop+z.offsetHeight>N){const Q=u(H,N),j=l.querySelector(`[data-line="${Q}"]`);W=j?j.offsetTop-Te(j,"margin-top"):W,X=a(Q),te=(L-W)/(N-W),le=H-X}else M===((x=l.firstElementChild)==null?void 0:x.firstElementChild)?(M===z&&(K=z.offsetTop+z.offsetHeight+ +getComputedStyle(z).marginBottom.replace("px","")),le=ae,te=Math.max(L/K,0)):(te=Math.max((L-W)/(K-W),0),le=ae-X);o(e,X+le*te,()=>{h--})},p=k=>{var b;const{scrollDOM:w,contentHeight:T}=n,S=w.clientHeight;if(T<=S||l.firstElementChild.clientHeight<=l.clientHeight||n.state.doc.lines<=((b=f[f.length-1])==null?void 0:b.end))return!1;k.target===e?v():y()};return[()=>{r(),e.addEventListener("scroll",p),l.addEventListener("scroll",p),e.dispatchEvent(new Event("scroll"))},()=>{e.removeEventListener("scroll",p),l.removeEventListener("scroll",p)}]},vo={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},Gl=V({props:vo,setup(e){const l=A("scrollElementRef"),t=A("roorNodeRef");return()=>{const{tocItem:n,mdHeadingId:o,onClick:a,scrollElementOffsetTop:c}=e;return d("div",{class:[`${s}-catalog-link`,n.active&&`${s}-catalog-active`],onClick:f=>{a(f,n),f.stopPropagation();const i=o(n.text,n.level,n.index),m=t.value.getElementById(i),r=l.value;if(m&&r){let u=m.offsetParent,g=m.offsetTop;if(r.contains(u))for(;u&&r!=u;)g+=u==null?void 0:u.offsetTop,u=u==null?void 0:u.offsetParent;const h=m.previousElementSibling;let v=0;h||(v=Te(m,"margin-top")),r==null||r.scrollTo({top:g-c-v,behavior:"smooth"})}}},[d("span",{title:n.text},[n.text]),d("div",{class:`${s}-catalog-wrapper`},[n.children&&n.children.map(f=>d(Gl,{mdHeadingId:o,key:`${n.text}-link-${f.level}-${f.text}`,tocItem:f,onClick:a,scrollElementOffsetTop:c},null))])])}}}),po={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function},onActive:{type:Function},isScrollElementInShadow:{type:Boolean,default:!1}},Ee=V({name:"MdCatalog",props:po,emits:["onClick","onActive"],setup(e,l){const t=e.editorId,n=`#${t}-preview-wrapper`,o=ee({list:[],show:!1,scrollElement:e.scrollElement||n}),a=ge(),c=R(),f=R(),i=R(),m=R();re("scrollElementRef",f),re("roorNodeRef",m);const r=J(()=>{const v=[];return o.list.forEach((y,p)=>{const{text:k,level:b}=y,w={level:b,text:k,index:p+1,active:a.value===y};if(v.length===0)v.push(w);else{let T=v[v.length-1];if(w.level>T.level)for(let S=T.level+1;S<=6;S++){const{children:x}=T;if(!x){T.children=[w];break}if(T=x[x.length-1],w.level<=T.level){x.push(w);break}}else v.push(w)}}),v}),u=()=>{var v;if(o.scrollElement instanceof HTMLElement)return o.scrollElement;let y=document;return(o.scrollElement===n||e.isScrollElementInShadow)&&(y=(v=c.value)==null?void 0:v.getRootNode()),y.querySelector(o.scrollElement)},g=v=>{if(v.length===0)return o.list=[],!1;const{activeHead:y}=v.reduce((p,k,b)=>{var w;const T=(w=m.value)==null?void 0:w.getElementById(e.mdHeadingId(k.text,k.level,b+1));if(T instanceof HTMLElement){const S=so(T,f.value);if(S<e.offsetTop&&S>p.minTop)return{activeHead:k,minTop:S}}return p},{activeHead:v[0],minTop:Number.MIN_SAFE_INTEGER});a.value=y,o.list=v},h=()=>{g(o.list)};return _(()=>a.value,v=>{const y=v?{...v}:void 0;e.onActive?e.onActive(y):l.emit("onActive",y)}),U(()=>{m.value=c.value.getRootNode();let v=u();f.value=v,$.on(t,{name:Pe,callback:y=>{var p,k;v=u(),f.value=v,i.value=v===document.documentElement?document:v,(p=i.value)==null||p.removeEventListener("scroll",h),g(y),(k=i.value)==null||k.addEventListener("scroll",h)}}),$.emit(t,Wl)}),Ce(()=>{var v;(v=i.value)==null||v.removeEventListener("scroll",h)}),()=>d("div",{class:[`${s}-catalog`,e.theme==="dark"&&`${s}-catalog-dark`,e.class||""],ref:c},[r.value.map(v=>d(Gl,{mdHeadingId:e.mdHeadingId,tocItem:v,key:`link-${v.level}-${v.text}`,onClick:(y,p)=>{e.onClick?e.onClick(y,p):l.emit("onClick",y,p)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}});Ee.install=e=>(e.component(Ee.name,Ee),e);function bo(e,l){for(var t=0;t<l.length;t++){const n=l[t];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(n,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const yo=(e,l)=>{const t=A("editorId"),{noImgZoomIn:n}=e,o=it(()=>{const a=document.querySelectorAll(`#${t}-preview img:not(.not-zoom):not(.medium-zoom-image)`);a.length!==0&&On(a,{background:"#00000073"})});U(()=>{!n&&e.setting.preview&&o()}),_([l,ce(e.setting,"preview")],()=>{!n&&e.setting.preview&&o()})},ko=(e,l,t)=>{const n=A("editorId"),o=A("rootRef"),a=A("usedLanguageText"),c=()=>{o.value.querySelectorAll(`#${n} .${s}-preview .${s}-code`).forEach(m=>{let r=-1;const u=m.querySelector(`.${s}-copy-button`);u&&(u.onclick=g=>{g.preventDefault(),clearTimeout(r);const v=(m.querySelector("input:checked + pre code")||m.querySelector("pre code")).textContent,y=Bn(e.formatCopiedText(v)),{text:p,successTips:k,failTips:b}=a.value.copyCode,w=y?k:b;u.dataset.isIcon?u.dataset.tips=w:u.innerHTML=w,r=window.setTimeout(()=>{u.dataset.isIcon?u.dataset.tips=p:u.innerHTML=p},1500)})})},f=()=>{ue(c)},i=m=>{m&&ue(c)};_([l,t],f),_(()=>e.setting.preview,i),_(()=>e.setting.htmlPreview,i),_(()=>a.value,c),U(c)},wo=e=>{const l=A("highlight"),t=ge(G.editorExtensions.highlight.instance);return U(()=>{e.noHighlight||t.value||(ne("link",{...l.value.css,rel:"stylesheet",id:`${s}-hlCss`}),ne("script",{...l.value.js,id:`${s}-hljs`,onload(){t.value=window.hljs}},"hljs"))}),_(()=>l.value.css,()=>{e.noHighlight||t.value||oo("link",{...l.value.css,rel:"stylesheet",id:`${s}-hlCss`})}),t},Ne=new Un({max:1e3,ttl:6e5}),Co=e=>{const l=A("theme"),t=A("rootRef"),{editorExtensions:n,editorExtensionsAttrs:o,mermaidConfig:a}=G,c=ge(n.mermaid.instance),f=ge(-1),i=()=>{const r=c.value;!e.noMermaid&&r&&(r.initialize(a({startOnLoad:!1,theme:l.value==="dark"?"dark":"default"})),f.value=f.value+1)};return _(()=>l.value,()=>{Ne.clear(),i()}),U(()=>{var r,u;if(e.noMermaid||c.value)return;const g=n.mermaid.js;/\.mjs/.test(g)?(ne("link",{...(r=o.mermaid)==null?void 0:r.js,rel:"modulepreload",href:g,id:`${s}-mermaid-m`}),import(g).then(h=>{c.value=h.default,i()})):ne("script",{...(u=o.mermaid)==null?void 0:u.js,src:g,id:`${s}-mermaid`,onload(){c.value=window.mermaid,i()}},"mermaid")}),{mermaidRef:c,reRenderRef:f,replaceMermaid:async()=>{if(!e.noMermaid&&c.value){const r=t.value.querySelectorAll(`div.${s}-mermaid`),u=document.createElement("div"),g=document.body.offsetWidth>1366?document.body.offsetWidth:1366,h=document.body.offsetHeight>768?document.body.offsetHeight:768;u.style.width=g+"px",u.style.height=h+"px",u.style.position="fixed",u.style.zIndex="-10000",u.style.top="-10000";let v=r.length;v>0&&document.body.appendChild(u),await Promise.allSettled(Array.from(r).map(y=>(async k=>{let b=Ne.get(k.innerText);if(!b){const T=tt(),S=c.value.renderAsync||c.value.render;let x="";try{x=await S(T,k.innerText,u)}catch{}b=await e.sanitizeMermaid(typeof x=="string"?x:x.svg)}const w=document.createElement("p");w.className=`${s}-mermaid`,w.setAttribute("data-processed",""),w.innerHTML=b,w.children[0].removeAttribute("height"),Ne.set(k.innerText,w.innerHTML),k.dataset.line!==void 0&&(w.dataset.line=k.dataset.line),k.replaceWith(w),--v===0&&u.remove()})(y)))}}}},$o=e=>{const l=ge(G.editorExtensions.katex.instance);return U(()=>{if(e.noKatex||l.value)return;const{editorExtensions:t}=G;ne("script",{src:t.katex.js,id:`${s}-katex`,onload(){l.value=window.katex}},"katex"),ne("link",{rel:"stylesheet",href:t.katex.css,id:`${s}-katexCss`})}),l},To=(e,l)=>{const t=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(n,o,a,c,f)=>{const i=n[o],m=i.content.trim();if(i.info==="mermaid"){let r;n[o].map&&n[o].level===0&&(r=n[o].map[0],n[o].attrSet("data-line",String(r)));const u=Ne.get(m);return u?`<p class="${s}-mermaid" ${r!==void 0?"data-line="+r:""} data-processed>${u}</p>`:`<div class="${s}-mermaid" ${r!==void 0?"data-line="+r:""} data-mermaid-theme=${l.themeRef.value}>${m}</div>`}return t(n,o,a,c,f)}},Ve=(e,l)=>{const t=e.attrs?e.attrs.slice():[];return l.forEach(n=>{const o=e.attrIndex(n[0]);o<0?t.push(n):(t[o]=t[o].slice(),t[o][1]+=` ${n[1]}`)}),t},So=(e,l)=>{const t=[{open:"$",close:"$"},{open:"\\(",close:"\\)"}];let n,o,a;for(const c of t)if(e.src.startsWith(c.open,e.pos)){const f=e.pos+c.open.length;for(n=f;(n=e.src.indexOf(c.close,n))!==-1;){for(a=n-1;e.src[a]==="\\";)a-=1;if((n-a)%2==1)break;n+=c.close.length}return n===-1?(l||(e.pending+=c.open),e.pos=f,!0):n-f===0?(l||(e.pending+=c.open+c.close),e.pos=f+c.close.length,!0):(l||(o=e.push("math_inline","math",0),o.markup=c.open,o.content=e.src.slice(f,n)),e.pos=n+c.close.length,!0)}return!1},xo=(e,l,t,n)=>{const o=[{open:"$$",close:"$$"},{open:"\\[",close:"\\]"}];let a,c,f,i,m=!1,r=e.bMarks[l]+e.tShift[l],u=e.eMarks[l];for(const g of o){if(r+g.open.length>u||e.src.slice(r,r+g.open.length)!==g.open)continue;if(r+=g.open.length,a=e.src.slice(r,u),n)return!0;for(a.trim().slice(-g.close.length)===g.close&&(a=a.trim().slice(0,-g.close.length),m=!0),f=l;!m&&(f++,!(f>=t||(r=e.bMarks[f]+e.tShift[f],u=e.eMarks[f],r<u&&e.tShift[f]<e.blkIndent)));)e.src.slice(r,u).trim().slice(-g.close.length)===g.close&&(i=e.src.slice(0,u).lastIndexOf(g.close),c=e.src.slice(r,i),m=!0);e.line=f+1;const h=e.push("math_block","math",0);return h.block=!0,h.content=(a&&a.trim()?a+`
`:"")+e.getLines(l+1,f,e.tShift[l],!0)+(c&&c.trim()?c:""),h.map=[l,e.line],h.markup=g.open,!0}return!1},Eo=(e,{katexRef:l})=>{const t=(o,a,c,f,i)=>{const m=o[a],r={attrs:Ve(m,[["class",`${s}-katex-inline`]])};if(l.value){const u=l.value.renderToString(m.content,G.katexConfig({throwOnError:!1}));return`<span ${i.renderAttrs(r)} data-processed>${u}</span>`}else return`<span ${i.renderAttrs(r)}>${m.content}</span>`},n=(o,a,c,f,i)=>{const m=o[a],r={attrs:Ve(m,[["class",`${s}-katex-block`]])};if(l.value){const u=l.value.renderToString(m.content,G.katexConfig({throwOnError:!1,displayMode:!0}));return`<p ${i.renderAttrs(r)} data-processed>${u}</p>`}else return`<p ${i.renderAttrs(r)}>${m.content}</p>`};e.inline.ruler.before("escape","math_inline",So),e.block.ruler.after("blockquote","math_block",xo,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=t,e.renderer.rules.math_block=n},Ao=(e,l)=>{l=l||{};const t=3,n=l.marker||"!",o=n.charCodeAt(0),a=n.length;let c="",f="";const i=(r,u,g,h,v)=>{const y=r[u];return y.type==="admonition_open"?r[u].attrPush(["class",`${s}-admonition ${s}-admonition-${y.info}`]):y.type==="admonition_title_open"&&r[u].attrPush(["class",`${s}-admonition-title`]),v.renderToken(r,u,g)},m=r=>{const u=r.trim().split(" ",2);f="",c=u[0],u.length>1&&(f=r.substring(c.length+2))};e.block.ruler.before("code","admonition",(r,u,g,h)=>{let v,y,p,k=!1,b=r.bMarks[u]+r.tShift[u],w=r.eMarks[u];if(o!==r.src.charCodeAt(b))return!1;for(v=b+1;v<=w&&n[(v-b)%a]===r.src[v];v++);const T=Math.floor((v-b)/a);if(T!==t)return!1;v-=(v-b)%a;const S=r.src.slice(b,v),x=r.src.slice(v,w);if(m(x),h)return!0;for(y=u;y++,!(y>=g||(b=r.bMarks[y]+r.tShift[y],w=r.eMarks[y],b<w&&r.sCount[y]<r.blkIndent));)if(o===r.src.charCodeAt(b)&&!(r.sCount[y]-r.blkIndent>=4)){for(v=b+1;v<=w&&n[(v-b)%a]===r.src[v];v++);if(!(Math.floor((v-b)/a)<T)&&(v-=(v-b)%a,v=r.skipSpaces(v),!(v<w))){k=!0;break}}const B=r.parentType,L=r.lineMax;return r.parentType="root",r.lineMax=y,p=r.push("admonition_open","div",1),p.markup=S,p.block=!0,p.info=c,p.map=[u,y],f&&(p=r.push("admonition_title_open","p",1),p.markup=S+" "+c,p.map=[u,y],p=r.push("inline","",0),p.content=f,p.map=[u,r.line-1],p.children=[],p=r.push("admonition_title_close","p",-1),p.markup=S+" "+c),r.md.block.tokenize(r,u+1,y),p=r.push("admonition_close","div",-1),p.markup=r.src.slice(b,v),p.block=!0,r.parentType=B,r.lineMax=L,r.line=y+(k?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=i,e.renderer.rules.admonition_title_open=i,e.renderer.rules.admonition_title_close=i,e.renderer.rules.admonition_close=i},_o=(e,l)=>{e.renderer.rules.heading_open=(t,n)=>{var o;const a=t[n],c=((o=t[n+1].children)==null?void 0:o.reduce((i,m)=>i+(["text","code_inline","math_inline"].includes(m.type)&&m.content||""),""))||"",f=a.markup.length;return l.headsRef.value.push({text:c,level:f}),a.map&&a.level===0&&a.attrSet("id",l.mdHeadingId(c,f,l.headsRef.value.length)),e.renderer.renderToken(t,n,l)},e.renderer.rules.heading_close=(t,n,o,a,c)=>c.renderToken(t,n,o)},Io=(e,l)=>{if(typeof l[e]=="string")return l[e];const t=`<i class="${s}-iconfont ${s}-icon-${e}"></i>`;switch(G.iconfontType){case"svg":return`<svg class="${s}-icon" aria-hidden="true"><use xlink:href="#${s}-icon-${e}"></use></svg>`;default:return t}},Lo=Io,Ho=(e,l)=>{const t=e.renderer.rules.fence,n=e.utils.unescapeAll,o=/\[(\w*)(?::([\w ]*))?\]/,a=/::(open|close)/,c=u=>u.info?n(u.info).trim():"",f=u=>{const g=c(u),[h=null,v=""]=(o.exec(g)||[]).slice(1);return[h,v]},i=u=>{const g=c(u);return g?g.split(/(\s+)/g)[0]:""},m=u=>{const g=u.info.match(a)||[],h=g[1]==="open"||g[1]!=="close"&&l.codeFoldable&&u.content.trim().split(`
`).length<l.autoFoldThreshold,v=g[1]||l.codeFoldable?"details":"div",y=g[1]||l.codeFoldable?"summary":"div";return{open:h,tagContainer:v,tagHeader:y}},r=(u,g,h,v,y)=>{var p;if(u[g].hidden)return"";const k=(p=l.usedLanguageTextRef.value)==null?void 0:p.copyCode.text,b=l.customIconRef.value.copy||k,w=!!l.customIconRef.value.copy,T=`<span class="${s}-collapse-tips">${Lo("collapse-tips",l.customIconRef.value)}</span>`,[S]=f(u[g]);if(S===null){const{open:q,tagContainer:X,tagHeader:ae}=m(u[g]),le=[["class",`${s}-code`]];q&&le.push(["open",""]);const Q={attrs:Ve(u[g],le)};u[g].info=u[g].info.replace(a,"");const j=t(u,g,h,v,y);return`<${X} ${y.renderAttrs(Q)}>
        <${ae} class="${s}-code-head">
          <div class="${s}-code-flag"><span></span><span></span><span></span></div>
          <div class="${s}-code-action">
            <span class="${s}-code-lang">${u[g].info.trim()}</span>
            <span class="${s}-copy-button" data-tips="${k}"${w?" data-is-icon=true":""}">${b}</span>
            ${X==="details"?T:""}
          </div>
        </${ae}>${j}</${X}>`}let x,B,L,E,H="",N="",M="";const{open:z,tagContainer:W,tagHeader:K}=m(u[g]),te=[["class",`${s}-code`]];z&&te.push(["open",""]);const oe={attrs:Ve(u[g],te)};for(let q=g;q<u.length&&(x=u[q],[B,L]=f(x),B===S);q++){x.info=x.info.replace(o,"").replace(a,""),x.hidden=!0;const X=`${s}-codetab-${l.editorId}-${g}-${q-g}`;E=q-g>0?"":"checked",H+=`<li>
          <input type="radio" name="${s}-codetab-label-${l.editorId}-${g}" class="${X}" ${E}>
          <label onclick="this.getRootNode().querySelectorAll('.${X}').forEach(e => e.click())">${L||i(x)}</label>
        </li>`,N+=`<input type="radio" name="${s}-codetab-pre-${l.editorId}-${g}" class="${X}" ${E}>
      ${t(u,q,h,v,y)}`,M+=`<input type="radio" name="${s}-codetab-lang-${l.editorId}-${g}" class="${X}" ${E}>
      <span class=${s}-code-lang>${i(x)}</span>`}return`<${W} ${y.renderAttrs(oe)}>
    <${K} class="${s}-code-head">
      <div class="${s}-code-flag">
        <ul class="${s}-codetab-label">${H}</ul>
      </div>
      <div class="${s}-code-action">
        <span class="${s}-codetab-lang">${M}</span>
        <span class="${s}-copy-button" data-tips="${k}"${w?" data-is-icon=true":""}">${b}</span>
        ${W==="details"?T:""}
      </div>
    </${K}>${N}</${W}>`};e.renderer.rules.fence=r,e.renderer.rules.code_block=r};function Fo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var at={exports:{}},D={},rt={exports:{}},ve={};function ql(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function Ro(e,l,t){}function Mo(e,l,t){}var Po=/javascript\s*\:/img;function No(e,l){return Po.test(l)?"":l}ve.whiteList=ql();ve.getDefaultWhiteList=ql;ve.onAttr=Ro;ve.onIgnoreAttr=Mo;ve.safeAttrValue=No;var Oo={indexOf:function(e,l){var t,n;if(Array.prototype.indexOf)return e.indexOf(l);for(t=0,n=e.length;t<n;t++)if(e[t]===l)return t;return-1},forEach:function(e,l,t){var n,o;if(Array.prototype.forEach)return e.forEach(l,t);for(n=0,o=e.length;n<o;n++)l.call(t,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},$e=Oo;function Bo(e,l){e=$e.trimRight(e),e[e.length-1]!==";"&&(e+=";");var t=e.length,n=!1,o=0,a=0,c="";function f(){if(!n){var r=$e.trim(e.slice(o,a)),u=r.indexOf(":");if(u!==-1){var g=$e.trim(r.slice(0,u)),h=$e.trim(r.slice(u+1));if(g){var v=l(o,c.length,g,h,r);v&&(c+=v+"; ")}}}o=a+1}for(;a<t;a++){var i=e[a];if(i==="/"&&e[a+1]==="*"){var m=e.indexOf("*/",a+2);if(m===-1)break;a=m+1,o=a+1,n=!1}else i==="("?n=!0:i===")"?n=!1:i===";"?n||f():i===`
`&&f()}return $e.trim(c)}var Do=Bo,Ie=ve,jo=Do;function hl(e){return e==null}function Vo(e){var l={};for(var t in e)l[t]=e[t];return l}function Xl(e){e=Vo(e||{}),e.whiteList=e.whiteList||Ie.whiteList,e.onAttr=e.onAttr||Ie.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||Ie.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||Ie.safeAttrValue,this.options=e}Xl.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var l=this,t=l.options,n=t.whiteList,o=t.onAttr,a=t.onIgnoreAttr,c=t.safeAttrValue,f=jo(e,function(i,m,r,u,g){var h=n[r],v=!1;if(h===!0?v=h:typeof h=="function"?v=h(u):h instanceof RegExp&&(v=h.test(u)),v!==!0&&(v=!1),u=c(r,u),!!u){var y={position:m,sourcePosition:i,source:g,isWhite:v};if(v){var p=o(r,u,y);return hl(p)?r+":"+u:p}else{var p=a(r,u,y);if(!hl(p))return p}}});return f};var Wo=Xl;(function(e,l){var t=ve,n=Wo;function o(c,f){var i=new n(f);return i.process(c)}l=e.exports=o,l.FilterCSS=n;for(var a in t)l[a]=t[a];typeof window<"u"&&(window.filterCSS=e.exports)})(rt,rt.exports);var ut=rt.exports,dt={indexOf:function(e,l){var t,n;if(Array.prototype.indexOf)return e.indexOf(l);for(t=0,n=e.length;t<n;t++)if(e[t]===l)return t;return-1},forEach:function(e,l,t){var n,o;if(Array.prototype.forEach)return e.forEach(l,t);for(n=0,o=e.length;n<o;n++)l.call(t,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var l=/\s|\n|\t/,t=l.exec(e);return t?t.index:-1}},Uo=ut.FilterCSS,zo=ut.getDefaultWhiteList,We=dt;function Kl(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Yl=new Uo;function Go(e,l,t){}function qo(e,l,t){}function Xo(e,l,t){}function Ko(e,l,t){}function Zl(e){return e.replace(Zo,"&lt;").replace(Jo,"&gt;")}function Yo(e,l,t,n){if(t=nn(t),l==="href"||l==="src"){if(t=We.trim(t),t==="#")return"#";if(!(t.substr(0,7)==="http://"||t.substr(0,8)==="https://"||t.substr(0,7)==="mailto:"||t.substr(0,4)==="tel:"||t.substr(0,11)==="data:image/"||t.substr(0,6)==="ftp://"||t.substr(0,2)==="./"||t.substr(0,3)==="../"||t[0]==="#"||t[0]==="/"))return""}else if(l==="background"){if(Le.lastIndex=0,Le.test(t))return""}else if(l==="style"){if(vl.lastIndex=0,vl.test(t)||(pl.lastIndex=0,pl.test(t)&&(Le.lastIndex=0,Le.test(t))))return"";n!==!1&&(n=n||Yl,t=n.process(t))}return t=on(t),t}var Zo=/</g,Jo=/>/g,Qo=/"/g,ea=/&quot;/g,ta=/&#([a-zA-Z0-9]*);?/gim,la=/&colon;?/gim,na=/&newline;?/gim,Le=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,vl=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,pl=/u\s*r\s*l\s*\(.*/gi;function Jl(e){return e.replace(Qo,"&quot;")}function Ql(e){return e.replace(ea,'"')}function en(e){return e.replace(ta,function(t,n){return n[0]==="x"||n[0]==="X"?String.fromCharCode(parseInt(n.substr(1),16)):String.fromCharCode(parseInt(n,10))})}function tn(e){return e.replace(la,":").replace(na," ")}function ln(e){for(var l="",t=0,n=e.length;t<n;t++)l+=e.charCodeAt(t)<32?" ":e.charAt(t);return We.trim(l)}function nn(e){return e=Ql(e),e=en(e),e=tn(e),e=ln(e),e}function on(e){return e=Jl(e),e=Zl(e),e}function oa(){return""}function aa(e,l){typeof l!="function"&&(l=function(){});var t=!Array.isArray(e);function n(c){return t?!0:We.indexOf(e,c)!==-1}var o=[],a=!1;return{onIgnoreTag:function(c,f,i){if(n(c))if(i.isClosing){var m="[/removed]",r=i.position+m.length;return o.push([a!==!1?a:i.position,r]),a=!1,m}else return a||(a=i.position),"[removed]";else return l(c,f,i)},remove:function(c){var f="",i=0;return We.forEach(o,function(m){f+=c.slice(i,m[0]),i=m[1]}),f+=c.slice(i),f}}}function ra(e){for(var l="",t=0;t<e.length;){var n=e.indexOf("<!--",t);if(n===-1){l+=e.slice(t);break}l+=e.slice(t,n);var o=e.indexOf("-->",n);if(o===-1)break;t=o+3}return l}function ia(e){var l=e.split("");return l=l.filter(function(t){var n=t.charCodeAt(0);return n===127?!1:n<=31?n===10||n===13:!0}),l.join("")}D.whiteList=Kl();D.getDefaultWhiteList=Kl;D.onTag=Go;D.onIgnoreTag=qo;D.onTagAttr=Xo;D.onIgnoreTagAttr=Ko;D.safeAttrValue=Yo;D.escapeHtml=Zl;D.escapeQuote=Jl;D.unescapeQuote=Ql;D.escapeHtmlEntities=en;D.escapeDangerHtml5Entities=tn;D.clearNonPrintableCharacter=ln;D.friendlyAttrValue=nn;D.escapeAttrValue=on;D.onIgnoreTagStripAll=oa;D.StripTagBody=aa;D.stripCommentTag=ra;D.stripBlankChar=ia;D.attributeWrapSign='"';D.cssFilter=Yl;D.getDefaultCSSWhiteList=zo;var qe={},me=dt;function sa(e){var l=me.spaceIndex(e),t;return l===-1?t=e.slice(1,-1):t=e.slice(1,l+1),t=me.trim(t).toLowerCase(),t.slice(0,1)==="/"&&(t=t.slice(1)),t.slice(-1)==="/"&&(t=t.slice(0,-1)),t}function ca(e){return e.slice(0,2)==="</"}function ua(e,l,t){var n="",o=0,a=!1,c=!1,f=0,i=e.length,m="",r="";e:for(f=0;f<i;f++){var u=e.charAt(f);if(a===!1){if(u==="<"){a=f;continue}}else if(c===!1){if(u==="<"){n+=t(e.slice(o,f)),a=f,o=f;continue}if(u===">"||f===i-1){n+=t(e.slice(o,a)),r=e.slice(a,f+1),m=sa(r),n+=l(a,n.length,m,r,ca(r)),o=f+1,a=!1;continue}if(u==='"'||u==="'")for(var g=1,h=e.charAt(f-g);h.trim()===""||h==="=";){if(h==="="){c=u;continue e}h=e.charAt(f-++g)}}else if(u===c){c=!1;continue}}return o<i&&(n+=t(e.substr(o))),n}var da=/[^a-zA-Z0-9\\_:.-]/gim;function fa(e,l){var t=0,n=0,o=[],a=!1,c=e.length;function f(g,h){if(g=me.trim(g),g=g.replace(da,"").toLowerCase(),!(g.length<1)){var v=l(g,h||"");v&&o.push(v)}}for(var i=0;i<c;i++){var m=e.charAt(i),r,u;if(a===!1&&m==="="){a=e.slice(t,i),t=i+1,n=e.charAt(t)==='"'||e.charAt(t)==="'"?t:ga(e,i+1);continue}if(a!==!1&&i===n){if(u=e.indexOf(m,i+1),u===-1)break;r=me.trim(e.slice(n+1,u)),f(a,r),a=!1,i=u,t=i+1;continue}if(/\s|\n|\t/.test(m))if(e=e.replace(/\s|\n|\t/g," "),a===!1)if(u=ma(e,i),u===-1){r=me.trim(e.slice(t,i)),f(r),a=!1,t=i+1;continue}else{i=u-1;continue}else if(u=ha(e,i-1),u===-1){r=me.trim(e.slice(t,i)),r=bl(r),f(a,r),a=!1,t=i+1;continue}else continue}return t<e.length&&(a===!1?f(e.slice(t)):f(a,bl(me.trim(e.slice(t))))),me.trim(o.join(" "))}function ma(e,l){for(;l<e.length;l++){var t=e[l];if(t!==" ")return t==="="?l:-1}}function ga(e,l){for(;l<e.length;l++){var t=e[l];if(t!==" ")return t==="'"||t==='"'?l:-1}}function ha(e,l){for(;l>0;l--){var t=e[l];if(t!==" ")return t==="="?l:-1}}function va(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function bl(e){return va(e)?e.substr(1,e.length-2):e}qe.parseTag=ua;qe.parseAttr=fa;var pa=ut.FilterCSS,ie=D,an=qe,ba=an.parseTag,ya=an.parseAttr,Oe=dt;function He(e){return e==null}function ka(e){var l=Oe.spaceIndex(e);if(l===-1)return{html:"",closing:e[e.length-2]==="/"};e=Oe.trim(e.slice(l+1,-1));var t=e[e.length-1]==="/";return t&&(e=Oe.trim(e.slice(0,-1))),{html:e,closing:t}}function wa(e){var l={};for(var t in e)l[t]=e[t];return l}function Ca(e){var l={};for(var t in e)Array.isArray(e[t])?l[t.toLowerCase()]=e[t].map(function(n){return n.toLowerCase()}):l[t.toLowerCase()]=e[t];return l}function rn(e){e=wa(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=ie.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=Ca(e.whiteList||e.allowList):e.whiteList=ie.whiteList,this.attributeWrapSign=e.singleQuotedAttributeValue===!0?"'":ie.attributeWrapSign,e.onTag=e.onTag||ie.onTag,e.onTagAttr=e.onTagAttr||ie.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||ie.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||ie.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||ie.safeAttrValue,e.escapeHtml=e.escapeHtml||ie.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new pa(e.css))}rn.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var l=this,t=l.options,n=t.whiteList,o=t.onTag,a=t.onIgnoreTag,c=t.onTagAttr,f=t.onIgnoreTagAttr,i=t.safeAttrValue,m=t.escapeHtml,r=l.attributeWrapSign,u=l.cssFilter;t.stripBlankChar&&(e=ie.stripBlankChar(e)),t.allowCommentTag||(e=ie.stripCommentTag(e));var g=!1;t.stripIgnoreTagBody&&(g=ie.StripTagBody(t.stripIgnoreTagBody,a),a=g.onIgnoreTag);var h=ba(e,function(v,y,p,k,b){var w={sourcePosition:v,position:y,isClosing:b,isWhite:Object.prototype.hasOwnProperty.call(n,p)},T=o(p,k,w);if(!He(T))return T;if(w.isWhite){if(w.isClosing)return"</"+p+">";var S=ka(k),x=n[p],B=ya(S.html,function(L,E){var H=Oe.indexOf(x,L)!==-1,N=c(p,L,E,H);return He(N)?H?(E=i(p,L,E,u),E?L+"="+r+E+r:L):(N=f(p,L,E,H),He(N)?void 0:N):N});return k="<"+p,B&&(k+=" "+B),S.closing&&(k+=" /"),k+=">",k}else return T=a(p,k,w),He(T)?m(k):T},m);return g&&(h=g.remove(h)),h};var $a=rn;(function(e,l){var t=D,n=qe,o=$a;function a(f,i){var m=new o(i);return m.process(f)}l=e.exports=a,l.filterXSS=a,l.FilterXSS=o,function(){for(var f in t)l[f]=t[f];for(var i in n)l[i]=n[i]}(),typeof window<"u"&&(window.filterXSS=e.exports);function c(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}c()&&(self.filterXSS=e.exports)})(at,at.exports);var Ae=at.exports;const Ta=Fo(Ae),Sa=bo({__proto__:null,default:Ta},[Ae]),yl={img:["class"],input:["class","disabled","type","checked"],iframe:["class","width","height","src","title","border","frameborder","framespacing","allow","allowfullscreen"]},xa=(e,l)=>{const{extendedWhiteList:t={},xss:n={}}=l;let o;if(typeof n=="function")o=new Ae.FilterXSS(n(Sa));else{const a=Ae.getDefaultWhiteList();[...Object.keys(t),...Object.keys(yl)].forEach(f=>{const i=a[f]||[],m=yl[f]||[],r=t[f]||[];a[f]=[...new Set([...i,...m,...r])]}),o=new Ae.FilterXSS({whiteList:a,...n})}e.core.ruler.after("linkify","xss",a=>{for(let c=0;c<a.tokens.length;c++){const f=a.tokens[c];switch(f.type){case"html_block":{f.content=o.process(f.content);break}case"inline":{(f.children||[]).forEach(m=>{m.type==="html_inline"&&(m.content=o.process(m.content))});break}}}})},kl=(e,l,t)=>{const n=e.attrIndex(l),o=[l,t];n<0?e.attrPush(o):(e.attrs=e.attrs||[],e.attrs[n]=o)},Ea=e=>e.type==="inline",Aa=e=>e.type==="paragraph_open",_a=e=>e.type==="list_item_open",Ia=e=>e.content.indexOf("[ ] ")===0||e.content.indexOf("[x] ")===0||e.content.indexOf("[X] ")===0,La=(e,l)=>Ea(e[l])&&Aa(e[l-1])&&_a(e[l-2])&&Ia(e[l]),Ha=(e,l)=>{const t=e[l].level-1;for(let n=l-1;n>=0;n--)if(e[n].level===t)return n;return-1},Fa=e=>{const l=new e("html_inline","",0);return l.content="<label>",l},Ra=e=>{const l=new e("html_inline","",0);return l.content="</label>",l},Ma=(e,l,t)=>{const n=new t("html_inline","",0);return n.content='<label class="task-list-item-label" for="'+l+'">'+e+"</label>",n.attrs=[{for:l}],n},Pa=(e,l,t)=>{const n=new l("html_inline","",0),o=t.enabled?" ":' disabled="" ';return e.content.indexOf("[ ] ")===0?n.content='<input class="task-list-item-checkbox"'+o+'type="checkbox">':(e.content.indexOf("[x] ")===0||e.content.indexOf("[X] ")===0)&&(n.content='<input class="task-list-item-checkbox" checked=""'+o+'type="checkbox">'),n},Na=(e,l,t)=>{if(e.children=e.children||[],e.children.unshift(Pa(e,l,t)),e.children[1].content=e.children[1].content.slice(3),e.content=e.content.slice(3),t.label)if(t.labelAfter){e.children.pop();const n="task-item-"+Math.ceil(Math.random()*(1e4*1e3)-1e3);e.children[0].content=e.children[0].content.slice(0,-1)+' id="'+n+'">',e.children.push(Ma(e.content,n,l))}else e.children.unshift(Fa(l)),e.children.push(Ra(l))},Oa=(e,l={})=>{e.core.ruler.after("inline","github-task-lists",t=>{const n=t.tokens;for(let o=2;o<n.length;o++)La(n,o)&&(Na(n[o],t.Token,l),kl(n[o-2],"class","task-list-item"+(l.enabled?" enabled":" ")),kl(n[Ha(n,o-2)],"class","contains-task-list"))})},Ba=e=>{e.core.ruler.push("init-line-number",l=>(l.tokens.forEach(t=>{t.map&&(t.attrs||(t.attrs=[]),t.attrs.push(["data-line",t.map[0].toString()]))}),!0))},Da=(e,l)=>{const{editorConfig:t,markdownItConfig:n,markdownItPlugins:o}=G,a=A("editorId"),c=A("language"),f=A("usedLanguageText"),i=A("showCodeRowNumber"),m=A("theme"),r=A("customIcon"),u=A("rootRef"),g=R([]),h=wo(e),v=$o(e),{reRenderRef:y,replaceMermaid:p}=Co(e),k=Dn({html:!0,breaks:!0,linkify:!0});n(k,{editorId:a});const b=[{type:"image",plugin:jn,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Ao,options:{}},{type:"taskList",plugin:Oa,options:{}},{type:"heading",plugin:_o,options:{mdHeadingId:e.mdHeadingId,headsRef:g}},{type:"code",plugin:Ho,options:{editorId:a,usedLanguageTextRef:f,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold,customIconRef:r}},{type:"xss",plugin:xa,options:{}},{type:"sub",plugin:Vn,options:{}},{type:"sup",plugin:Wn,options:{}}];e.noKatex||b.push({type:"katex",plugin:Eo,options:{katexRef:v}}),e.noMermaid||b.push({type:"mermaid",plugin:To,options:{themeRef:m}}),o(b,{editorId:a}).forEach(E=>{k.use(E.plugin,E.options)});const w=k.options.highlight;k.set({highlight:(E,H,N)=>{if(w){const W=w(E,H,N);if(W)return W}let M;!e.noHighlight&&h.value?h.value.getLanguage(H)?M=h.value.highlight(E,{language:H,ignoreIllegals:!0}).value:M=h.value.highlightAuto(E).value:M=k.utils.escapeHtml(E);const z=i?io(M.replace(/^\n+|\n+$/g,""),E.replace(/^\n+|\n+$/g,"")):`<span class="${s}-code-block">${M.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${H}" language=${H}>${z}</code></pre>`}}),Ba(k);const T=R(`_article-key_${tt()}`),S=R(e.sanitize(k.render(e.modelValue))),x=()=>{$.emit(a,Me,S.value),e.onHtmlChanged(S.value),e.onGetCatalog(g.value),$.emit(a,Pe,g.value),ue(()=>{p().then(()=>{ml(u.value.querySelectorAll(`#${a} .${s}-mermaid`))})})};U(x);const B=()=>{g.value=[],S.value=e.sanitize(k.render(e.modelValue)),x()},L=J(()=>(e.noKatex||v.value)&&(e.noHighlight||h.value));return _([ce(e,"modelValue"),L,y,c],it(B,l?0:t.renderDelay)),_(()=>e.setting.preview,()=>{e.setting.preview&&ue(()=>{p().then(()=>{ml(u.value.querySelectorAll(`#${a} .${s}-mermaid`))}),$.emit(a,Pe,g.value)})}),U(()=>{$.on(a,{name:Wl,callback(){$.emit(a,Pe,g.value)}}),$.on(a,{name:ct,callback:()=>{T.value=`_article-key_${tt()}`,B()}})}),{html:S,key:T}},wl={checked:{regexp:/- \[x\]/,value:"- [ ]"},unChecked:{regexp:/- \[\s\]/,value:"- [x]"}},ja=(e,l)=>{const t=A("editorId"),n=A("rootRef");let o=()=>{};const a=()=>{if(!n.value)return!1;const c=n.value.querySelectorAll(".task-list-item.enabled"),f=i=>{var m;i.preventDefault();const r=i.target.checked?"unChecked":"checked",u=(m=i.target.parentElement)==null?void 0:m.dataset.line;if(!u)return;const g=Number(u),h=e.modelValue.split(`
`),v=h[Number(g)].replace(wl[r].regexp,wl[r].value);e.previewOnly?(h[Number(g)]=v,e.onChange(h.join(`
`))):$.emit(t,zl,g+1,v)};c.forEach(i=>{i.addEventListener("click",f)}),o=()=>{c.forEach(i=>{i.removeEventListener("click",f)})}};Ce(()=>{o()}),_([l],()=>{o(),ue(a)},{immediate:!0})},sn={modelValue:{type:String,default:""},onChange:{type:Function,default:()=>{}},setting:{type:Object,default:()=>({preview:!0})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function},codeFoldable:{type:Boolean},autoFoldThreshold:{type:Number}},Va={...sn,updateModelValue:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function},transformImgUrl:{type:Function,default:e=>e}},cn=V({name:"ContentPreview",props:sn,setup(e){const l=A("editorId"),t=A("previewTheme"),n=A("showCodeRowNumber"),{html:o,key:a}=Da(e,e.previewOnly);return ko(e,o,a),yo(e,o),ja(e,o),()=>d(Ue,null,[e.setting.preview&&d("div",{id:`${l}-preview-wrapper`,class:`${s}-preview-wrapper`,key:"content-preview-wrapper"},[d("div",{key:a.value,id:`${l}-preview`,class:[`${s}-preview`,`${t==null?void 0:t.value}-theme`,n&&`${s}-scrn`],innerHTML:o.value},null)]),!e.previewOnly&&e.setting.htmlPreview&&d("div",{id:`${l}-html-wrapper`,class:`${s}-preview-wrapper`,key:"html-preview-wrapper"},[d("div",{class:`${s}-html`},[o.value])])])}}),Wa=(e,l)=>{const{editorId:t}=e,n=ee({buildFinished:!1,html:""});_(()=>e.modelValue,()=>{n.buildFinished=!1}),U(()=>{$.on(t,{name:Me,callback(o){n.buildFinished=!0,n.html=o}}),$.on(t,{name:ze,callback(){const o=new Promise(a=>{if(n.buildFinished)a(n.html);else{const c=f=>{a(f),$.remove(t,Me,c)};$.on(t,{name:Me,callback:c})}});e.onSave?e.onSave(e.modelValue,o):l.emit("onSave",e.modelValue,o)}})})},un=(e,l)=>{const{editorId:t}=e,n=G.editorExtensions.highlight,o=G.editorExtensionsAttrs.highlight;re("editorId",t),re("rootRef",l),re("theme",J(()=>e.theme)),re("language",J(()=>e.language)),re("highlight",J(()=>{const{js:c}=n,f={...nt,...n.css},{js:i,css:m={}}=o||{},r=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme,u=f[e.codeTheme]?f[e.codeTheme][r]:nt.atom[r],g=f[e.codeTheme]&&m[e.codeTheme]?m[e.codeTheme][r]:m.atom?m.atom[r]:{};return{js:{src:c,...i},css:{href:u,...g}}})),re("showCodeRowNumber",e.showCodeRowNumber);const a=J(()=>{const c={...al,...G.editorConfig.languageUserDefined};return hn(vn(al["en-US"]),c[e.language]||{})});re("usedLanguageText",a),re("previewTheme",J(()=>e.previewTheme)),re("customIcon",J(()=>e.customIcon))},Ua=(e,l)=>{un(e,l),re("tabWidth",e.tabWidth)},dn=e=>{U(()=>{const{editorExtensions:l,editorExtensionsAttrs:t,iconfontType:n}=G;e.noIconfont||(n==="svg"?ne("script",{...t.iconfont,src:l.iconfont,id:`${s}-icon`}):ne("link",{...t.iconfontClass,rel:"stylesheet",href:l.iconfontClass,id:`${s}-icon-class`}))})},za=e=>{const{noPrettier:l,noUploadImg:t}=e,{editorExtensions:n,editorExtensionsAttrs:o}=G,a=l||n.prettier.prettierInstance,c=l||n.prettier.parserMarkdownInstance,f=t||n.cropper.instance;U(()=>{if(!f){const{js:i={},css:m={}}=o.cropper||{};ne("link",{...m,rel:"stylesheet",href:n.cropper.css,id:`${s}-cropperCss`}),ne("script",{...i,src:n.cropper.js,id:`${s}-cropper`})}if(!a){const{standaloneJs:i={}}=o.prettier||{};ne("script",{...i,src:n.prettier.standaloneJs,id:`${s}-prettier`})}if(!c){const{parserMarkdownJs:i={}}=o.prettier||{};ne("script",{...i,src:n.prettier.parserMarkdownJs,id:`${s}-prettierMD`})}}),dn(e)},Ga=(e,l)=>{const{editorId:t}=e;U(()=>{$.on(t,{name:he,callback:n=>{e.onError instanceof Function?e.onError(n):l.emit("onError",n)}})})},qa=(e,l)=>{const{editorId:t}=e,n=ee({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:e.preview?!1:e.htmlPreview,previewOnly:!1}),o=ee({...n}),a=(i,m)=>{const r=m===void 0?!n[i]:m;switch(i){case"preview":{n.htmlPreview=!1,n.previewOnly=!1;break}case"htmlPreview":{n.preview=!1,n.previewOnly=!1;break}case"previewOnly":{r?!n.preview&&!n.htmlPreview&&(n.preview=!0):(o.preview||(n.preview=!1),o.htmlPreview||(n.htmlPreview=!1));break}}o[i]=r,n[i]=r};let c="";const f=()=>{n.pageFullscreen||n.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=c};return _(()=>[n.pageFullscreen,n.fullscreen],f),U(()=>{$.on(t,{name:Ge,callback(i,m){const r=u=>{$.emit(t,P,"image",{desc:"",urls:u}),m&&m()};e.onUploadImg?e.onUploadImg(i,r):l.emit("onUploadImg",i,r)}}),c=document.body.style.overflow,f()}),[n,a]},Xa=e=>{const{editorId:l}=e,t=R(!1);return U(()=>{$.on(l,{name:st,callback:o=>{o===void 0?t.value=!t.value:t.value=o}})}),J(()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&t.value)},Ka=(e,l,t,n,o,a)=>{const{editorId:c}=e;_(()=>n.pageFullscreen,i=>{$.emit(c,rl,i)}),_(()=>n.fullscreen,i=>{$.emit(c,il,i)}),_(()=>n.preview,i=>{$.emit(c,sl,i)}),_(()=>n.previewOnly,i=>{$.emit(c,cl,i)}),_(()=>n.htmlPreview,i=>{$.emit(c,ul,i)}),_(t,i=>{$.emit(c,dl,i)});const f={on(i,m){switch(i){case"pageFullscreen":{$.on(c,{name:rl,callback(r){m(r)}});break}case"fullscreen":{$.on(c,{name:il,callback(r){m(r)}});break}case"preview":{$.on(c,{name:sl,callback(r){m(r)}});break}case"previewOnly":{$.on(c,{name:cl,callback(r){m(r)}});break}case"htmlPreview":{$.on(c,{name:ul,callback(r){m(r)}});break}case"catalog":{$.on(c,{name:dl,callback(r){m(r)}});break}}},togglePageFullscreen(i){o("pageFullscreen",i)},toggleFullscreen(i){$.emit(c,Dl,i)},togglePreview(i){o("preview",i)},togglePreviewOnly(i){o("previewOnly",i)},toggleHtmlPreview(i){o("htmlPreview",i)},toggleCatalog(i){$.emit(c,st,i)},triggerSave(){$.emit(c,ze)},insert(i){$.emit(c,P,"universal",{generate:i})},focus(i){var m;(m=a.value)==null||m.focus(i)},rerender(){$.emit(c,ct)},getSelectedText(){var i;return(i=a.value)==null?void 0:i.getSelectedText()},resetHistory(){var i;(i=a.value)==null||i.resetHistory()},domEventHandlers(i){$.emit(c,Ul,i)},execCommand(i){$.emit(c,P,i)},getEditorView(){var i;return(i=a.value)==null?void 0:i.getEditorView()}};l.expose(f)},Ya=e=>e,fn={modelValue:{type:String,default:""},onChange:{type:Function},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:()=>co("md-editor-v3_")},showCodeRowNumber:{type:Boolean,default:!0},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:Ya},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:e=>Promise.resolve(e)},codeFoldable:{type:Boolean,default:!0},autoFoldThreshold:{type:Number,default:30}},Za={...fn,onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:Ol},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:Bl},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function},transformImgUrl:{type:Function,default:e=>e}},mn=["onHtmlChanged","onGetCatalog","onChange","update:modelValue"],Ja=[...mn,"onSave","onUploadImg","onError","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],Qa=(e,l)=>{const{editorId:t}=e,n={rerender(){$.emit(t,ct)}};l.expose(n)},Be=V({name:"MdPreview",props:fn,emits:mn,setup(e,l){const{editorId:t,noKatex:n,noMermaid:o,noHighlight:a}=e,c=R();return un(e,c),dn(e),Qa(e,l),Ce(()=>{$.clear(t)}),()=>d("div",{id:t,class:[s,e.class,e.theme==="dark"&&`${s}-dark`,`${s}-previewOnly`],style:e.style,ref:c},[d(cn,{modelValue:e.modelValue,onChange:f=>{e.onChange&&e.onChange(f),l.emit("onChange",f),l.emit("update:modelValue",f)},onHtmlChanged:f=>{e.onHtmlChanged?e.onHtmlChanged(f):l.emit("onHtmlChanged",f)},onGetCatalog:f=>{e.onGetCatalog?e.onGetCatalog(f):l.emit("onGetCatalog",f)},mdHeadingId:e.mdHeadingId,noMermaid:o,sanitize:e.sanitize,noKatex:n,formatCopiedText:e.formatCopiedText,noHighlight:a,noImgZoomIn:e.noImgZoomIn,previewOnly:!0,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null)])}});Be.install=e=>(e.component(Be.name,Be),e);const er={title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},De=V({name:"NormalToolbar",props:er,emits:["onClick"],setup(e,l){return()=>{const t=se({props:e,ctx:l},"trigger");return d("div",{class:`${s}-toolbar-item`,title:e.title,onClick:n=>{e.onClick instanceof Function?e.onClick(n):l.emit("onClick",n)}},[t])}}});De.install=e=>(e.component(De.name,De),e);function tr(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Cn(e)}const lr={title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},class:{type:String},style:{type:[Object,String]},showMask:{type:Boolean,default:!0},insert:{type:Function},language:{type:String},theme:{type:String},previewTheme:{type:String}},je=V({name:"ModalToolbar",props:lr,emits:["onClick","onClose","onAdjust"],setup(e,l){return()=>{const t=se({props:e,ctx:l},"trigger"),n=se({props:e,ctx:l},"default");return d(Ue,null,[d("div",{class:`${s}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():l.emit("onClick")}},[t]),d(we,{style:e.style,class:e.class,width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,showMask:e.showMask,onClose:()=>{e.onClose instanceof Function?e.onClose():l.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:o=>{e.onAdjust instanceof Function?e.onAdjust(o):l.emit("onAdjust",o)}},tr(n)?n:{default:()=>[n]})])}}});je.install=e=>(e.component(je.name,je),e);var nr=Object.defineProperty,or=(e,l,t)=>l in e?nr(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,fe=(e,l,t)=>or(e,typeof l!="symbol"?l+"":l,t);const ar=V({setup(){return()=>d("div",{class:`${s}-divider`},null)}}),rr={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean},catalogVisible:{type:Boolean}},ir=e=>{const l=A("editorId"),{editorExtensions:t,editorExtensionsAttrs:n}=G;let o=t.screenfull.instance;const a=R(!1),c=m=>{if(!o){$.emit(l,he,{name:"fullscreen",message:"fullscreen is undefined"});return}o.isEnabled?(a.value=!0,(m===void 0?!o.isFullscreen:m)?o.request():o.exit()):console.error("browser does not support screenfull!")},f=()=>{o&&o.isEnabled&&o.on("change",()=>{(a.value||e.setting.fullscreen)&&(a.value=!1,e.updateSetting("fullscreen"))})},i=()=>{o=window.screenfull,f()};return U(()=>{var m;f(),o||ne("script",{...(m=n.screenfull)==null?void 0:m.js,src:t.screenfull.js,id:`${s}-screenfull`,onload:i},"screenfull")}),U(()=>{$.on(l,{name:Dl,callback:c})}),{fullscreenHandler:c}},sr={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},cr=V({name:"TableShape",props:sr,setup(e){const l=ee({x:-1,y:-1}),t=J(()=>JSON.stringify(e.tableShape)),n=()=>{const a=[...JSON.parse(t.value)];return(!a[2]||a[2]<a[0])&&(a[2]=a[0]),(!a[3]||a[3]<a[3])&&(a[3]=a[1]),a},o=R(n());return _([t],()=>{o.value=n()}),()=>d("div",{class:`${s}-table-shape`,onMouseleave:()=>{o.value=n(),l.x=-1,l.y=-1}},[new Array(o.value[1]).fill("").map((a,c)=>d("div",{class:`${s}-table-shape-row`,key:`table-shape-row-${c}`},[new Array(o.value[0]).fill("").map((f,i)=>d("div",{class:`${s}-table-shape-col`,key:`table-shape-col-${i}`,onMouseenter:()=>{l.x=c,l.y=i,i+1===o.value[0]&&i+1<o.value[2]?o.value[0]++:i+2<o.value[0]&&o.value[0]>e.tableShape[0]&&o.value[0]--,c+1===o.value[1]&&c+1<o.value[3]?o.value[1]++:c+2<o.value[1]&&o.value[1]>e.tableShape[1]&&o.value[1]--},onClick:()=>{e.onSelected(l)}},[d("div",{class:[`${s}-table-shape-col-default`,c<=l.x&&i<=l.y&&`${s}-table-shape-col-include`]},null)]))]))])}}),ur={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},dr=V({props:ur,setup(e){const l=A("usedLanguageText"),t=A("editorId"),n=J(()=>{var a,c;switch(e.type){case"link":return(a=l.value.linkModalTips)==null?void 0:a.linkTitle;case"image":return(c=l.value.linkModalTips)==null?void 0:c.imageTitle;default:return""}}),o=ee({desc:"",url:""});return _(()=>e.visible,a=>{a||setTimeout(()=>{o.desc="",o.url=""},200)}),()=>d(we,{title:n.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var a,c,f,i,m;return[d("div",{class:`${s}-form-item`},[d("label",{class:`${s}-label`,for:`link-desc-${t}`},[(a=l.value.linkModalTips)==null?void 0:a.descLabel]),d("input",{placeholder:(c=l.value.linkModalTips)==null?void 0:c.descLabelPlaceHolder,class:`${s}-input`,id:`link-desc-${t}`,type:"text",value:o.desc,onChange:r=>{o.desc=r.target.value},autocomplete:"off"},null)]),d("div",{class:`${s}-form-item`},[d("label",{class:`${s}-label`,for:`link-url-${t}`},[(f=l.value.linkModalTips)==null?void 0:f.urlLabel]),d("input",{placeholder:(i=l.value.linkModalTips)==null?void 0:i.urlLabelPlaceHolder,class:`${s}-input`,id:`link-url-${t}`,type:"text",value:o.url,onChange:r=>{o.url=r.target.value},autocomplete:"off"},null)]),d("div",{class:`${s}-form-item`},[d("button",{class:[`${s}-btn`,`${s}-btn-row`],type:"button",onClick:()=>{e.onOk(o),o.desc="",o.url=""}},[(m=l.value.linkModalTips)==null?void 0:m.buttonOK])])]}})}}),fr={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},mr=V({props:fr,setup(e){const l=A("usedLanguageText"),t=A("editorId"),n=A("rootRef");let o=G.editorExtensions.cropper.instance;const a=R(),c=R(),f=R(),i=ee({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let m=null;_(()=>e.visible,()=>{e.visible&&!i.cropperInited&&(o=o||window.Cropper,a.value.onchange=()=>{if(!o){$.emit(t,he,{name:"Cropper",message:"Cropper is undefined"});return}const u=a.value.files||[];if(i.imgSelected=!0,(u==null?void 0:u.length)>0){const g=new FileReader;g.onload=h=>{i.imgSrc=h.target.result},g.readAsDataURL(u[0])}})}),_(()=>[i.imgSelected],()=>{f.value.style=""}),_([ce(()=>i.isFullscreen),ce(()=>i.imgSrc)],()=>{i.imgSrc&&ue(()=>{m==null||m.destroy(),f.value.style="",c.value&&(m=new o(c.value,{viewMode:2,preview:n.value.getRootNode().querySelector(`.${s}-clip-preview-target`)}))})});const r=()=>{m.clear(),m.destroy(),m=null,a.value.value="",i.imgSelected=!1};return()=>{var u;return d(we,{class:`${s}-modal-clip`,title:(u=l.value.clipModalTips)==null?void 0:u.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:i.isFullscreen,onAdjust:g=>{i.isFullscreen=g},width:"668px",height:"421px"},{default:()=>{var g,h;return[d("div",{class:`${s}-form-item ${s}-clip`},[d("div",{class:`${s}-clip-main`},[i.imgSelected?d("div",{class:`${s}-clip-cropper`},[d("img",{src:i.imgSrc,ref:c,style:{display:"none"},alt:""},null),d("div",{class:`${s}-clip-delete`,onClick:r},[d(I,{name:"delete"},null)])]):d("div",{class:`${s}-clip-upload`,onClick:()=>{a.value.click()}},[d(I,{name:"upload"},null)])]),d("div",{class:`${s}-clip-preview`},[d("div",{class:`${s}-clip-preview-target`,ref:f},null)])]),d("div",{class:`${s}-form-item`},[d("button",{class:`${s}-btn`,type:"button",onClick:()=>{if(m){const v=m.getCroppedCanvas();$.emit(t,Ge,[ro(v.toDataURL("image/png"))],e.onOk),r()}}},[((g=l.value.clipModalTips)==null?void 0:g.buttonUpload)||((h=l.value.linkModalTips)==null?void 0:h.buttonOK)])]),d("input",{ref:a,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),gr={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},hr=V({props:gr,setup(e){return()=>d(Ue,null,[d(dr,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),d(mr,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}}),vr=V({name:"MDEditorToolbar",props:rr,setup(e){const l=A("editorId"),t=A("usedLanguageText"),n=A("theme"),o=A("previewTheme"),a=A("language"),{fullscreenHandler:c}=ir(e),f=`${l}-toolbar-wrapper`,i=R(),m=ee({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),r=(k,b)=>{$.emit(l,P,k,b)},u=ee({type:"link",linkVisible:!1,clipVisible:!1}),g=R();U(()=>{$.on(l,{name:ot,callback(k){u.type=k,u.linkVisible=!0}})});const h=J(()=>{const k=e.toolbars.filter(S=>!e.toolbarsExclude.includes(S)),b=k.indexOf("="),w=b===-1?k:k.slice(0,b+1),T=b===-1?[]:k.slice(b,Number.MAX_SAFE_INTEGER);return[w,T]}),v=R(),y=()=>{$.emit(l,Ge,Array.from(v.value.files||[])),v.value.value=""};U(()=>{v.value.addEventListener("change",y)});const p=k=>{var b,w,T,S,x,B,L,E,H,N,M,z,W,K,te,oe,q,X,ae,le,Q,j,Y,Xe,ft,mt,gt,ht,vt,pt,bt,yt,kt,wt,Ct,$t,Tt,St,xt,Et,At,_t,It,Lt,Ht,Ft,Rt,Mt,Pt,Nt,Ot,Bt,Dt,jt,Vt,Wt,Ut,zt,Gt,qt,Xt,Kt,Yt,Zt,Jt,Qt,el,tl,ll;if(Ol.includes(k))switch(k){case"-":return d(ar,null,null);case"bold":return d("div",{class:`${s}-toolbar-item`,title:(b=t.value.toolbarTips)==null?void 0:b.bold,onClick:()=>{r("bold")}},[d(I,{name:"bold"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(w=t.value.toolbarTips)==null?void 0:w.bold])]);case"underline":return d("div",{class:`${s}-toolbar-item`,title:(T=t.value.toolbarTips)==null?void 0:T.underline,onClick:()=>{r("underline")}},[d(I,{name:"underline"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(S=t.value.toolbarTips)==null?void 0:S.underline])]);case"italic":return d("div",{class:`${s}-toolbar-item`,title:(x=t.value.toolbarTips)==null?void 0:x.italic,onClick:()=>{r("italic")}},[d(I,{name:"italic"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(B=t.value.toolbarTips)==null?void 0:B.italic])]);case"strikeThrough":return d("div",{class:`${s}-toolbar-item`,title:(L=t.value.toolbarTips)==null?void 0:L.strikeThrough,onClick:()=>{r("strikeThrough")}},[d(I,{name:"strike-through"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(E=t.value.toolbarTips)==null?void 0:E.strikeThrough])]);case"title":return d(ye,{relative:`#${f}`,visible:m.title,onChange:F=>{m.title=F},overlay:d("ul",{class:`${s}-menu`,onClick:()=>{m.title=!1}},[d("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{r("h1")}},[(H=t.value.titleItem)==null?void 0:H.h1]),d("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{r("h2")}},[(N=t.value.titleItem)==null?void 0:N.h2]),d("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{r("h3")}},[(M=t.value.titleItem)==null?void 0:M.h3]),d("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{r("h4")}},[(z=t.value.titleItem)==null?void 0:z.h4]),d("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{r("h5")}},[(W=t.value.titleItem)==null?void 0:W.h5]),d("li",{class:`${s}-menu-item ${s}-menu-item-title`,onClick:()=>{r("h6")}},[(K=t.value.titleItem)==null?void 0:K.h6])])},{default:()=>{var F,Z;return[d("div",{class:`${s}-toolbar-item`,title:(F=t.value.toolbarTips)==null?void 0:F.title},[d(I,{name:"title"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Z=t.value.toolbarTips)==null?void 0:Z.title])])]}});case"sub":return d("div",{class:`${s}-toolbar-item`,title:(te=t.value.toolbarTips)==null?void 0:te.sub,onClick:()=>{r("sub")}},[d(I,{name:"sub"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(oe=t.value.toolbarTips)==null?void 0:oe.sub])]);case"sup":return d("div",{class:`${s}-toolbar-item`,title:(q=t.value.toolbarTips)==null?void 0:q.sup,onClick:()=>{r("sup")}},[d(I,{name:"sup"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(X=t.value.toolbarTips)==null?void 0:X.sup])]);case"quote":return d("div",{class:`${s}-toolbar-item`,title:(ae=t.value.toolbarTips)==null?void 0:ae.quote,onClick:()=>{r("quote")}},[d(I,{name:"quote"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(le=t.value.toolbarTips)==null?void 0:le.quote])]);case"unorderedList":return d("div",{class:`${s}-toolbar-item`,title:(Q=t.value.toolbarTips)==null?void 0:Q.unorderedList,onClick:()=>{r("unorderedList")}},[d(I,{name:"unordered-list"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(j=t.value.toolbarTips)==null?void 0:j.unorderedList])]);case"orderedList":return d("div",{class:`${s}-toolbar-item`,title:(Y=t.value.toolbarTips)==null?void 0:Y.orderedList,onClick:()=>{r("orderedList")}},[d(I,{name:"ordered-list"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Xe=t.value.toolbarTips)==null?void 0:Xe.orderedList])]);case"task":return d("div",{class:`${s}-toolbar-item`,title:(ft=t.value.toolbarTips)==null?void 0:ft.task,onClick:()=>{r("task")}},[d(I,{name:"task"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(mt=t.value.toolbarTips)==null?void 0:mt.task])]);case"codeRow":return d("div",{class:`${s}-toolbar-item`,title:(gt=t.value.toolbarTips)==null?void 0:gt.codeRow,onClick:()=>{r("codeRow")}},[d(I,{name:"code-row"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(ht=t.value.toolbarTips)==null?void 0:ht.codeRow])]);case"code":return d("div",{class:`${s}-toolbar-item`,title:(vt=t.value.toolbarTips)==null?void 0:vt.code,onClick:()=>{r("code")}},[d(I,{name:"code"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(pt=t.value.toolbarTips)==null?void 0:pt.code])]);case"link":return d("div",{class:`${s}-toolbar-item`,title:(bt=t.value.toolbarTips)==null?void 0:bt.link,onClick:()=>{u.type="link",u.linkVisible=!0}},[d(I,{name:"link"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(yt=t.value.toolbarTips)==null?void 0:yt.link])]);case"image":return e.noUploadImg?d("div",{class:`${s}-toolbar-item`,title:(kt=t.value.toolbarTips)==null?void 0:kt.image,onClick:()=>{u.type="image",u.linkVisible=!0}},[d(I,{name:"image"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(wt=t.value.toolbarTips)==null?void 0:wt.image])]):d(ye,{relative:`#${f}`,visible:m.image,onChange:F=>{m.image=F},overlay:d("ul",{class:`${s}-menu`,onClick:()=>{m.title=!1}},[d("li",{class:`${s}-menu-item ${s}-menu-item-image`,onClick:()=>{u.type="image",u.linkVisible=!0}},[(Ct=t.value.imgTitleItem)==null?void 0:Ct.link]),d("li",{class:`${s}-menu-item ${s}-menu-item-image`,onClick:()=>{v.value.click()}},[($t=t.value.imgTitleItem)==null?void 0:$t.upload]),d("li",{class:`${s}-menu-item ${s}-menu-item-image`,onClick:()=>{u.clipVisible=!0}},[(Tt=t.value.imgTitleItem)==null?void 0:Tt.clip2upload])])},{default:()=>{var F,Z;return[d("div",{class:`${s}-toolbar-item`,title:(F=t.value.toolbarTips)==null?void 0:F.image},[d(I,{name:"image"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Z=t.value.toolbarTips)==null?void 0:Z.image])])]}});case"table":return d(ye,{relative:`#${f}`,visible:m.table,onChange:F=>{m.table=F},key:"bar-table",overlay:d(cr,{tableShape:e.tableShape,onSelected:F=>{r("table",{selectedShape:F})}},null)},{default:()=>{var F,Z;return[d("div",{class:`${s}-toolbar-item`,title:(F=t.value.toolbarTips)==null?void 0:F.table},[d(I,{name:"table"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Z=t.value.toolbarTips)==null?void 0:Z.table])])]}});case"revoke":return d("div",{class:`${s}-toolbar-item`,title:(St=t.value.toolbarTips)==null?void 0:St.revoke,onClick:()=>{$.emit(l,jl)}},[d(I,{name:"revoke"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(xt=t.value.toolbarTips)==null?void 0:xt.revoke])]);case"next":return d("div",{class:`${s}-toolbar-item`,title:(Et=t.value.toolbarTips)==null?void 0:Et.next,onClick:()=>{$.emit(l,Vl)}},[d(I,{name:"next"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(At=t.value.toolbarTips)==null?void 0:At.next])]);case"save":return d("div",{class:`${s}-toolbar-item`,title:(_t=t.value.toolbarTips)==null?void 0:_t.save,onClick:()=>{$.emit(l,ze)}},[d(I,{name:"baocun"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(It=t.value.toolbarTips)==null?void 0:It.save])]);case"prettier":return e.noPrettier?"":d("div",{class:`${s}-toolbar-item`,title:(Lt=t.value.toolbarTips)==null?void 0:Lt.prettier,onClick:()=>{r("prettier")}},[d(I,{name:"prettier"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Ht=t.value.toolbarTips)==null?void 0:Ht.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&d("div",{class:[`${s}-toolbar-item`,e.setting.pageFullscreen&&`${s}-toolbar-active`],title:(Ft=t.value.toolbarTips)==null?void 0:Ft.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[d(I,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Rt=t.value.toolbarTips)==null?void 0:Rt.pageFullscreen])]);case"fullscreen":return d("div",{class:[`${s}-toolbar-item`,e.setting.fullscreen&&`${s}-toolbar-active`],title:(Mt=t.value.toolbarTips)==null?void 0:Mt.fullscreen,onClick:()=>{c()}},[d(I,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Pt=t.value.toolbarTips)==null?void 0:Pt.fullscreen])]);case"preview":return d("div",{class:[`${s}-toolbar-item`,e.setting.preview&&`${s}-toolbar-active`],title:(Nt=t.value.toolbarTips)==null?void 0:Nt.preview,onClick:()=>{e.updateSetting("preview")}},[d(I,{name:"preview"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Ot=t.value.toolbarTips)==null?void 0:Ot.preview])]);case"previewOnly":return d("div",{class:[`${s}-toolbar-item`,e.setting.previewOnly&&`${s}-toolbar-active`],title:(Bt=t.value.toolbarTips)==null?void 0:Bt.previewOnly,onClick:()=>{e.updateSetting("previewOnly")}},[d(I,{name:"preview-only"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Dt=t.value.toolbarTips)==null?void 0:Dt.previewOnly])]);case"htmlPreview":return d("div",{class:[`${s}-toolbar-item`,e.setting.htmlPreview&&`${s}-toolbar-active`],title:(jt=t.value.toolbarTips)==null?void 0:jt.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[d(I,{name:"coding"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Vt=t.value.toolbarTips)==null?void 0:Vt.htmlPreview])]);case"catalog":return d("div",{class:[`${s}-toolbar-item`,e.catalogVisible&&`${s}-toolbar-active`],title:(Wt=t.value.toolbarTips)==null?void 0:Wt.catalog,onClick:()=>{$.emit(l,st)},key:"bar-catalog"},[d(I,{name:"catalog"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Ut=t.value.toolbarTips)==null?void 0:Ut.catalog])]);case"github":return d("div",{class:`${s}-toolbar-item`,title:(zt=t.value.toolbarTips)==null?void 0:zt.github,onClick:()=>bn("https://github.com/imzbf/md-editor-v3")},[d(I,{name:"github"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Gt=t.value.toolbarTips)==null?void 0:Gt.github])]);case"mermaid":return d(ye,{relative:`#${f}`,visible:m.mermaid,onChange:F=>{m.mermaid=F},overlay:d("ul",{class:`${s}-menu`,onClick:()=>{m.mermaid=!1}},[d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("flow")}},[(qt=t.value.mermaid)==null?void 0:qt.flow]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("sequence")}},[(Xt=t.value.mermaid)==null?void 0:Xt.sequence]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("gantt")}},[(Kt=t.value.mermaid)==null?void 0:Kt.gantt]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("class")}},[(Yt=t.value.mermaid)==null?void 0:Yt.class]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("state")}},[(Zt=t.value.mermaid)==null?void 0:Zt.state]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("pie")}},[(Jt=t.value.mermaid)==null?void 0:Jt.pie]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("relationship")}},[(Qt=t.value.mermaid)==null?void 0:Qt.relationship]),d("li",{class:`${s}-menu-item ${s}-menu-item-mermaid`,onClick:()=>{r("journey")}},[(el=t.value.mermaid)==null?void 0:el.journey])]),key:"bar-mermaid"},{default:()=>{var F,Z;return[d("div",{class:`${s}-toolbar-item`,title:(F=t.value.toolbarTips)==null?void 0:F.mermaid},[d(I,{name:"mermaid"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Z=t.value.toolbarTips)==null?void 0:Z.mermaid])])]}});case"katex":return d(ye,{relative:`#${f}`,visible:m.katex,onChange:F=>{m.katex=F},overlay:d("ul",{class:`${s}-menu`,onClick:()=>{m.katex=!1}},[d("li",{class:`${s}-menu-item ${s}-menu-item-katex`,onClick:()=>{r("katexInline")}},[(tl=t.value.katex)==null?void 0:tl.inline]),d("li",{class:`${s}-menu-item ${s}-menu-item-katex`,onClick:()=>{r("katexBlock")}},[(ll=t.value.katex)==null?void 0:ll.block])]),key:"bar-katex"},{default:()=>{var F,Z;return[d("div",{class:`${s}-toolbar-item`,title:(F=t.value.toolbarTips)==null?void 0:F.katex},[d(I,{name:"formula"},null),e.showToolbarName&&d("div",{class:`${s}-toolbar-item-name`},[(Z=t.value.toolbarTips)==null?void 0:Z.katex])])]}})}else if(e.defToolbars instanceof Array){const F=e.defToolbars[k];return F?lt(F,{theme:n.value,previewTheme:o.value,language:a.value,insert(Ke){$.emit(l,P,"universal",{generate:Ke})}}):""}else if(e.defToolbars&&e.defToolbars.children instanceof Array){const F=e.defToolbars.children[k];return F?lt(F,{theme:n.value,previewTheme:o.value,language:a.value,insert(Ke){$.emit(l,P,"universal",{generate:Ke})}}):""}else return""};return _(()=>e.toolbars,()=>{ue(()=>{i.value&&pn(i.value)})},{immediate:!0}),()=>{const k=h.value[0].map(w=>p(w)),b=h.value[1].map(w=>p(w));return d(Ue,null,[e.toolbars.length>0&&d("div",{class:`${s}-toolbar-wrapper`,ref:i,id:f},[d("div",{class:[`${s}-toolbar`,e.showToolbarName&&`${s}-stn`]},[d("div",{class:`${s}-toolbar-left`,ref:g},[k]),d("div",{class:`${s}-toolbar-right`},[b])])]),d("input",{ref:v,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),d(hr,{linkVisible:u.linkVisible,clipVisible:u.clipVisible,type:u.type,onCancel:()=>{u.linkVisible=!1,u.clipVisible=!1},onOk:w=>{w&&r(u.type,{desc:w.desc,url:w.url,transform:u.type==="image"}),u.linkVisible=!1,u.clipVisible=!1}},null)])}}}),pr=(e,l,t)=>{const n=A("editorId");let o=()=>{},a=()=>{};const c=()=>{var f;o();const i=(f=t.value)==null?void 0:f.view.contentDOM.getRootNode(),m=i.querySelector(`#${n} .cm-scroller`),r=i.querySelector(`[id="${n}-preview-wrapper"]`),u=i.querySelector(`[id="${n}-html-wrapper"]`);(r||u)&&([a,o]=(r?ho:go)(m,r||u,t.value),e.scrollAuto&&a())};_([l,ce(e.setting,"preview"),ce(e.setting,"htmlPreview"),ce(e.setting,"fullscreen"),ce(e.setting,"pageFullscreen")],()=>{ue(c)}),_(()=>e.scrollAuto,f=>{f?a():o()}),_(()=>e.setting.previewOnly,f=>{f?o():a()}),U(c)},Ze=async(e,l,t)=>{var n;let o="",a=0,c=0,f=!0,i=!1;const m=l.getSelectedText(),r=G.editorConfig.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const u=e.replace(/^h(\d)/,(g,h)=>new Array(Number(h)).fill("#",0,h).join(""));o=`${u} ${m}`,a=u.length+1}else if(e==="prettier"){const u=window.prettier||G.editorExtensions.prettier.prettierInstance,g=[((n=window.prettierPlugins)==null?void 0:n.markdown)||G.editorExtensions.prettier.parserMarkdownInstance];!u||g[0]===void 0?($.emit(t.editorId,he,{name:"prettier",message:"prettier is undefined"}),o=l.getValue()):o=await u.format(l.getValue(),{parser:"markdown",plugins:g}),f=!1,i=!0}else switch(e){case"bold":{o=`**${m}**`,a=2,c=-2;break}case"underline":{o=`<u>${m}</u>`,a=3,c=-4;break}case"italic":{o=`*${m}*`,a=1,c=-1;break}case"strikeThrough":{o=`~~${m}~~`,a=2,c=-2;break}case"sub":{o=`~${m}~`,a=1,c=-1;break}case"sup":{o=`^${m}^`,a=1,c=-1;break}case"codeRow":{o="`"+m+"`",a=1,c=-1;break}case"quote":{o=`> ${m}`,a=2;break}case"orderedList":{o=`1. ${m}`,a=3;break}case"unorderedList":{o=`- ${m}`,a=2;break}case"task":{o=`- [ ] ${m}`,a=6;break}case"code":{const u=t.text||m||"",g=t.mode||"language";o=`\`\`\`${g}
${u}
\`\`\`
`,a=3,c=3+g.length-o.length;break}case"table":{o="|";const{selectedShape:u={x:1,y:1}}=t,{x:g,y:h}=u;for(let v=0;v<=h;v++)o+=" col |";o+=`
|`;for(let v=0;v<=h;v++)o+=" - |";for(let v=0;v<=g;v++){o+=`
|`;for(let y=0;y<=h;y++)o+=" content |"}a=2,c=5-o.length;break}case"link":{const{desc:u,url:g}=t;o=`[${u}](${g})`,f=!1;break}case"image":{const{desc:u,url:g,urls:h}=t;h instanceof Array?o=h.reduce((v,y)=>{const{url:p="",alt:k="",title:b=""}=typeof y=="object"?y:{url:y};return v+`![${k}](${p}${b?" '"+b+"'":""})
`},""):o=`![${u}](${g})
`,f=!1;break}case"flow":{o=`\`\`\`mermaid
${(r==null?void 0:r.flow)||`flowchart TD 
  Start --> Stop`}
\`\`\`
`,a=11,c=-5;break}case"sequence":{o=`\`\`\`mermaid
${(r==null?void 0:r.sequence)||`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!
  A-)B: bye!`}
\`\`\`
`,a=11,c=-5;break}case"gantt":{o=`\`\`\`mermaid
${(r==null?void 0:r.gantt)||`gantt
title A Gantt Diagram
dateFormat  YYYY-MM-DD
section Section
A task  :a1, 2014-01-01, 30d
Another task  :after a1, 20d`}
\`\`\`
`,a=11,c=-5;break}case"class":{o=`\`\`\`mermaid
${(r==null?void 0:r.class)||`classDiagram
  class Animal
  Vehicle <|-- Car`}
\`\`\`
`,a=11,c=-5;break}case"state":{o=`\`\`\`mermaid
${(r==null?void 0:r.state)||`stateDiagram-v2
  s1 --> s2`}
\`\`\`
`,a=11,c=-5;break}case"pie":{o=`\`\`\`mermaid
${(r==null?void 0:r.pie)||`pie title Pets adopted by volunteers
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`}
\`\`\`
`,a=11,c=-5;break}case"relationship":{o=`\`\`\`mermaid
${(r==null?void 0:r.relationship)||`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows
  PERSON ||--o{ NAMED-DRIVER : is`}
\`\`\`
`,a=11,c=-5;break}case"journey":{o=`\`\`\`mermaid
${(r==null?void 0:r.journey)||`journey
  title My working day
  section Go to work
    Make tea: 5: Me
    Go upstairs: 3: Me
    Do work: 1: Me, Cat
  section Go home
    Go downstairs: 5: Me
    Sit down: 5: Me`}
\`\`\`
`,a=11,c=-5;break}case"katexInline":{o="$$",a=1,c=-1;break}case"katexBlock":{o=`$$

$$
`,a=3,c=-4;break}case"universal":{const{generate:u}=t,g=u(m);o=g.targetValue,f=g.select??!0,a=g.deviationStart||0,c=g.deviationEnd||0}}return{text:o,options:{select:f,deviationStart:a,deviationEnd:c,replaceAll:i}}},br="#e5c07b",Cl="var(--md-color)",yr="#56b6c2",kr="#ffffff",Se="var(--md-color)",$l="#e5c07b",wr="#e5c07b",Cr="var(--md-color)",Tl="#d19a66",$r="#c678dd",Tr="#21252b",Sr="#2c313a",Sl="var(--md-bk-color)",Je="var(--md-bk-color)",xr="#ceedfa33",xl="#528bff",Er=de.theme({"&":{color:Se,backgroundColor:Sl},".cm-content":{caretColor:xl},".cm-cursor, .cm-dropCursor":{borderLeftColor:xl},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:xr},".cm-panels":{backgroundColor:Tr,color:Se},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Sl,color:Se,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Sr},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Je},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Je,borderBottomColor:Je},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:Se}}},{dark:!0}),Ar=Pl.define([{tag:C.keyword,color:$r},{tag:[C.name,C.deleted,C.character,C.propertyName,C.macroName],color:Cl},{tag:[C.function(C.variableName),C.labelName],color:wr},{tag:[C.color,C.constant(C.name),C.standard(C.name)],color:Tl},{tag:[C.definition(C.name),C.separator],color:Se},{tag:[C.typeName,C.className,C.number,C.changed,C.annotation,C.modifier,C.self,C.namespace],color:br},{tag:[C.operator,C.operatorKeyword,C.url,C.escape,C.regexp,C.link,C.special(C.string)],color:yr},{tag:[C.meta,C.comment],color:$l},{tag:C.strong,fontWeight:"bold"},{tag:C.emphasis,fontStyle:"italic"},{tag:C.strikethrough,textDecoration:"line-through"},{tag:C.link,color:$l,textDecoration:"underline"},{tag:C.heading,fontWeight:"bold",color:Cl},{tag:[C.atom,C.bool,C.special(C.variableName)],color:Tl},{tag:[C.processingInstruction,C.string,C.inserted],color:Cr},{tag:C.invalid,color:kr}]),El=[Er,Nl(Ar)],_r="#e5c07b",Al="#3f4a54",Ir="#56b6c2",Lr="#fff",xe="#3f4a54",_l="#2d8cf0",Hr="#2d8cf0",Fr="#3f4a54",Il="#d19a66",Rr="#c678dd",Mr="#f6f6f6",Pr="#ceedfa33",Ll="var(--md-bk-color)",Qe="var(--md-bk-color)",Nr="#bad5fa",Hl="#3f4a54",Or=de.theme({"&":{color:xe,backgroundColor:Ll},".cm-content":{caretColor:Hl},".cm-cursor, .cm-dropCursor":{borderLeftColor:Hl},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Nr},".cm-panels":{backgroundColor:Mr,color:xe},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Ll,color:xe,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Pr},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Qe},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Qe,borderBottomColor:Qe},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:xe}}}),Br=Pl.define([{tag:C.keyword,color:Rr},{tag:[C.name,C.deleted,C.character,C.propertyName,C.macroName],color:Al},{tag:[C.function(C.variableName),C.labelName],color:Hr},{tag:[C.color,C.constant(C.name),C.standard(C.name)],color:Il},{tag:[C.definition(C.name),C.separator],color:xe},{tag:[C.typeName,C.className,C.number,C.changed,C.annotation,C.modifier,C.self,C.namespace],color:_r},{tag:[C.operator,C.operatorKeyword,C.url,C.escape,C.regexp,C.link,C.special(C.string)],color:Ir},{tag:[C.meta,C.comment],color:_l},{tag:C.strong,fontWeight:"bold"},{tag:C.emphasis,fontStyle:"italic"},{tag:C.strikethrough,textDecoration:"line-through"},{tag:C.link,color:_l,textDecoration:"underline"},{tag:C.heading,fontWeight:"bold",color:Al},{tag:[C.atom,C.bool,C.special(C.variableName)],color:Il},{tag:[C.processingInstruction,C.string,C.inserted],color:Fr},{tag:C.invalid,color:Lr}]),Fl=[Or,Nl(Br)],Fe=(e,l,t,n,o)=>(a,c,f,i)=>{const m=`${e}${l}`.slice(i-f);a.dispatch(a.state.replaceSelection(`${m}${t}${n}`));const r=f+c.label.length+(o==="title"?t.length:0);a.dispatch({selection:ke.create([ke.range(f+c.label.length+(o==="title"?1:-l.length),r),ke.cursor(r)],1)}),a.focus()},Rl=e=>(l,t,n,o)=>{const a=e.slice(o-n);l.dispatch(l.state.replaceSelection(`${a} `))},Ml=e=>{const l=t=>{const n=t.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|\$\$?|!+\s*\w*/);return n===null||n.from==n.to&&t.explicit?null:{from:n.from,options:[...["h2","h3","h4","h5","h6"].map((o,a)=>{const c=new Array(a+2).fill("#").join("");return{label:c,type:"text",apply:Rl(c)}}),...["unchecked","checked"].map(o=>{const a=o==="checked"?"- [x]":"- [ ]";return{label:a,type:"text",apply:Rl(a)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(o=>({label:`${o[0]}${o[1]}`,type:"text",apply:Fe(o[0],o[1],"",o[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:Fe("$","","","$","type")},{label:"$$",type:"text",apply:Fe("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(o=>({label:`!!! ${o}`,type:"text",apply:Fe("!!!",` ${o}`," Title",`

!!!`,"title")}))]}};return An({override:e?[l,...e]:[l]})},pe=e=>{const l=new be;return n=>(l.get(e.state)?e.dispatch({effects:l.reconfigure(n)}):e.dispatch({effects:Mn.appendConfig.of(l.of(n))}),!0)};class Dr{constructor(l){fe(this,"view"),fe(this,"maxLength",Number.MAX_SAFE_INTEGER),fe(this,"toggleTabSize"),fe(this,"togglePlaceholder"),fe(this,"setExtensions"),fe(this,"toggleDisabled"),fe(this,"toggleReadOnly"),fe(this,"toggleMaxlength"),this.view=l,this.toggleTabSize=pe(this.view),this.togglePlaceholder=pe(this.view),this.setExtensions=pe(this.view),this.toggleDisabled=pe(this.view),this.toggleReadOnly=pe(this.view),this.toggleMaxlength=pe(this.view)}getValue(){return this.view.state.doc.toString()}setValue(l,t=0,n=this.view.state.doc.length){this.view.dispatch({changes:{from:t,to:n,insert:l}})}getSelectedText(){const{from:l,to:t}=this.view.state.selection.main;return this.view.state.sliceDoc(l,t)}replaceSelectedText(l,t={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},n){try{if(t.replaceAll){if(this.setValue(l),l.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+l.length>this.maxLength)throw new Error("The input text is too long");const{from:o}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(l)),t.select){const a=o+l.length+t.deviationEnd;this.view.dispatch({selection:{anchor:o+t.deviationStart,head:a}})}this.view.focus()}catch(o){if(o.message==="The input text is too long")$.emit(n,he,{name:"overlength",message:o.message,data:l});else throw o}}setTabSize(l){this.toggleTabSize([Ye.tabSize.of(l),_n.of(" ".repeat(l))])}setPlaceholder(l){this.togglePlaceholder(In(l))}focus(l){if(this.view.focus(),!l)return;let t=0,n=0,o=0;switch(l){case"start":break;case"end":{t=n=o=this.getValue().length;break}default:t=l.rangeAnchor||l.cursorPos,n=l.rangeHead||l.cursorPos,o=l.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:ke.create([ke.range(t,n),ke.cursor(o)],1)})}setDisabled(l){this.toggleDisabled([de.editable.of(!l)])}setReadOnly(l){this.toggleReadOnly([Ye.readOnly.of(l)])}setMaxLength(l){this.maxLength=l,this.toggleMaxlength([Ye.changeFilter.of(t=>t.newDoc.length<=l)])}}const jr=(e,l)=>{const t=A("editorId"),n=a=>{a instanceof Promise?a.then(c=>{$.emit(t,P,"universal",{generate(){return{targetValue:c}}})}).catch(c=>{console.error(c)}):$.emit(t,P,"universal",{generate(){return{targetValue:a}}})};return a=>{var c,f,i;if(!a.clipboardData)return;if(a.clipboardData.files.length>0){const{files:y}=a.clipboardData;$.emit(t,Ge,Array.from(y).filter(p=>/image\/.*/.test(p.type))),a.preventDefault();return}const m=a.clipboardData.getData("text/plain"),r=((c=l.value)==null?void 0:c.view.state.selection.main.to)||0,u=((f=l.value)==null?void 0:f.view.state.doc.lineAt(r).from)||0,g=((i=l.value)==null?void 0:i.view.state.doc.sliceString(u,r))||"",h=/!\[.*\]\(\s*$/.test(g),v=/!\[.*\]\((.*)\s?.*\)/.test(m);if(h){const y=e.transformImgUrl(m);n(y),a.preventDefault();return}else if(v){const y=m.match(new RegExp(`(?<=!\\[.*\\]\\()([^)\\s]+)(?=\\s?["']?.*["']?\\))`,"g"));y?Promise.all(y.map(p=>e.transformImgUrl(p))).then(p=>{n(p.reduce((k,b,w)=>k.replace(y[w],b),m))}):n(m),a.preventDefault();return}if(e.autoDetectCode&&a.clipboardData.types.includes("vscode-editor-data")){const y=JSON.parse(a.clipboardData.getData("vscode-editor-data"));$.emit(t,P,"code",{mode:y.mode,text:a.clipboardData.getData("text/plain")}),a.preventDefault();return}e.maxlength&&m.length+e.modelValue.length>e.maxlength&&$.emit(t,he,{name:"overlength",message:"The input text is too long",data:m})}},Vr=(e,l)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>($.emit(e,P,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:Nn,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:T=>($.emit(e,ze,T.state.doc.toString()),!0),shift:()=>($.emit(e,P,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>($.emit(e,P,"underline"),!0),shift:()=>($.emit(e,P,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>($.emit(e,P,"italic"),!0),shift:()=>($.emit(e,ot,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>($.emit(e,P,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>($.emit(e,P,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>($.emit(e,P,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>($.emit(e,P,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>($.emit(e,P,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>($.emit(e,P,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>($.emit(e,P,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>($.emit(e,P,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>($.emit(e,P,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>($.emit(e,P,"code"),!0),any(T,S){return(S.ctrlKey||S.metaKey)&&S.altKey&&S.code==="KeyC"?($.emit(e,P,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>($.emit(e,ot,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>l.noPrettier?!1:($.emit(e,P,"prettier"),!0)},{any:(T,S)=>(S.ctrlKey||S.metaKey)&&S.altKey&&S.shiftKey&&S.code==="KeyT"?($.emit(e,P,"table"),!0):!1},...Pn];de.EDIT_CONTEXT=!1;const Wr=e=>{const l=A("tabWidth"),t=A("editorId"),n=A("theme"),o=R(),a=ge(),c=R(!1),f=new be,i=new be,m=new be,r=new be,u=new be,g=Vr(t,e),h=()=>[...Ln,...Hn,...g,Fn],y={paste:jr(e,a),blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,compositionstart:()=>{c.value=!0},compositionend:(b,w)=>{c.value=!1,e.updateModelValue(w.state.doc.toString())},input:b=>{e.onInput&&e.onInput(b);const{data:w}=b;e.maxlength&&e.modelValue.length+w.length>e.maxlength&&$.emit(t,he,{name:"overlength",message:"The input text is too long",data:w})}},p=[$n.of(h()),r.of(nl()),f.of(Tn({codeLanguages:Rn})),de.lineWrapping,de.updateListener.of(b=>{b.docChanged&&(e.onChange(b.state.doc.toString()),c.value||e.updateModelValue(b.state.doc.toString()))}),u.of(de.domEventHandlers(y)),Sn()],k=()=>{const b=[...p,i.of(n.value==="light"?Fl:El),m.of(Ml(e.completions))];return G.codeMirrorExtensions(n.value,b,h(),{editorId:t})};return U(()=>{const b=new de({doc:e.modelValue,parent:o.value,extensions:[k()]}),w=new Dr(b);a.value=w,setTimeout(()=>{w.setTabSize(l),w.setDisabled(e.disabled),w.setReadOnly(e.readonly),e.placeholder&&w.setPlaceholder(e.placeholder),typeof e.maxlength=="number"&&w.setMaxLength(e.maxlength),e.autofocus&&b.focus()},0),$.on(t,{name:jl,callback(){xn(b)}}),$.on(t,{name:Vl,callback(){En(b)}}),$.on(t,{name:P,async callback(T,S={}){var x,B;if(T==="image"&&S.transform){const L=e.transformImgUrl(S.url);if(L instanceof Promise)L.then(async E=>{var H;const{text:N,options:M}=await Ze(T,a.value,{...S,url:E});(H=a.value)==null||H.replaceSelectedText(N,M,t)}).catch(E=>{console.error(E)});else{const{text:E,options:H}=await Ze(T,a.value,{...S,url:L});(x=a.value)==null||x.replaceSelectedText(E,H,t)}}else{const{text:L,options:E}=await Ze(T,a.value,S);(B=a.value)==null||B.replaceSelectedText(L,E,t)}}}),$.on(t,{name:Ul,callback:yn(T=>{var S;const x={...y},B=Object.keys(y);for(const L in T){const E=L;B.includes(E)?x[E]=(H,N)=>{T[E](H,N),H.defaultPrevented||y[E](H,N)}:x[E]=T[E]}(S=a.value)==null||S.view.dispatch({effects:u.reconfigure(de.domEventHandlers(x))})})}),$.on(t,{name:zl,callback:(T,S)=>{const x=b.state.doc.line(T);b.dispatch(b.state.update({changes:{from:x.from,to:x.to,insert:S}}))}})}),_(n,()=>{var b;(b=a.value)==null||b.view.dispatch({effects:i.reconfigure(n.value==="light"?Fl:El)})},{deep:!0}),_(()=>e.completions,()=>{var b;(b=a.value)==null||b.view.dispatch({effects:m.reconfigure(Ml(e.completions))})},{deep:!0}),_(()=>e.modelValue,()=>{var b,w;((b=a.value)==null?void 0:b.getValue())!==e.modelValue&&((w=a.value)==null||w.setValue(e.modelValue))}),_(()=>e.placeholder,()=>{var b;(b=a.value)==null||b.setPlaceholder(e.placeholder)}),_(()=>e.disabled,()=>{var b;(b=a.value)==null||b.setDisabled(e.disabled)}),_(()=>e.readonly,()=>{var b;(b=a.value)==null||b.setDisabled(e.readonly)}),_(()=>e.maxlength,()=>{var b;e.maxlength&&((b=a.value)==null||b.setMaxLength(e.maxlength))}),{inputWrapperRef:o,codeMirrorUt:a,resetHistory(){var b,w;(b=a.value)==null||b.view.dispatch({effects:r.reconfigure([])}),(w=a.value)==null||w.view.dispatch({effects:r.reconfigure(nl())})}}},Ur=(e,l,t)=>{const n=ee({resizedWidth:e.inputBoxWitdh}),o=ee({width:e.inputBoxWitdh}),a=ee({left:e.inputBoxWitdh,display:"initial"}),c=R(e.setting.preview||e.setting.htmlPreview),f=r=>{var u,g,h;const v=((u=l.value)==null?void 0:u.offsetWidth)||0,y=((g=l.value)==null?void 0:g.getBoundingClientRect().x)||0;let p=r.x-y;p<_e?p=_e:p>v-_e&&(p=v-_e);const k=`${p}px`;o.width=k,a.left=k,n.resizedWidth=k,(h=e.onInputBoxWitdhChange)==null||h.call(e,k)},i=()=>{document.addEventListener("mousemove",f)},m=()=>{document.removeEventListener("mousemove",f)};return _([t],()=>{var r,u;(r=t.value)==null||r.addEventListener("mousedown",i),(u=t.value)==null||u.addEventListener("mouseup",m)},{immediate:!0}),Ce(()=>{var r,u;(r=t.value)==null||r.removeEventListener("mousedown",i),(u=t.value)==null||u.removeEventListener("mouseup",m)}),_(()=>e.inputBoxWitdh,r=>{r&&(n.resizedWidth=r,o.width=r,a.left=r)}),_([ce(e.setting,"htmlPreview"),ce(e.setting,"preview"),ce(e.setting,"previewOnly")],()=>{e.setting.previewOnly?(o.width="0%",a.display="none",c.value=!0):!e.setting.htmlPreview&&!e.setting.preview?(o.width="100%",a.display="none",c.value=!1):(o.width=n.resizedWidth,a.display="initial",c.value=!0)},{immediate:!0}),{inputWrapperStyle:o,resizeOperateStyle:a,showPreviewWrapper:c}},zr=V({name:"MDEditorContent",props:Va,setup(e,l){const t=A("editorId"),n=R(""),o=R(),a=R(),{inputWrapperRef:c,codeMirrorUt:f,resetHistory:i}=Wr(e),{inputWrapperStyle:m,resizeOperateStyle:r,showPreviewWrapper:u}=Ur(e,o,a);return pr(e,n,f),l.expose({getSelectedText(){var g;return(g=f.value)==null?void 0:g.getSelectedText()},focus(g){var h;(h=f.value)==null||h.focus(g)},resetHistory:i,getEditorView(){var g;return(g=f.value)==null?void 0:g.view}}),()=>d("div",{class:`${s}-content${u.value?" has-preview":""}`,ref:o},[d("div",{class:`${s}-input-wrapper`,style:m,ref:c},null),(e.setting.htmlPreview||e.setting.preview)&&d("div",{class:`${s}-resize-operate`,style:r,ref:a},null),u.value&&d(cn,{modelValue:e.modelValue,onChange:e.onChange,setting:e.setting,onHtmlChanged:g=>{n.value=g,e.onHtmlChanged(g)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null),e.catalogVisible&&d(Ee,{theme:e.theme,class:`${s}-catalog-editor`,editorId:t,mdHeadingId:e.mdHeadingId,key:"internal-catalog",scrollElementOffsetTop:2},null)])}}),Gr=V({props:{modelValue:{type:String,default:""}},setup(e){const l=A("usedLanguageText");return()=>{var t,n;return d("div",{class:`${s}-footer-item`},[d("label",{class:`${s}-footer-label`},[`${(t=l.value.footer)==null?void 0:t.markdownTotal}:`]),d("span",null,[((n=e.modelValue)==null?void 0:n.length)||0])])}}}),qr={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},Xr=V({props:qr,setup(e){return()=>d("div",{class:[`${s}-checkbox`,e.checked&&`${s}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}}),Kr={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},Yr=V({props:Kr,setup(e){const l=A("usedLanguageText");return()=>{var t;return d("div",{class:`${s}-footer-item`},[d("label",{class:`${s}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[(t=l.value.footer)==null?void 0:t.scrollAuto]),d(Xr,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),Zr={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},Jr=V({name:"MDEditorFooter",props:Zr,setup(e){const l=J(()=>{const n=e.footers.indexOf("="),o=n===-1?e.footers:e.footers.slice(0,n),a=n===-1?[]:e.footers.slice(n,Number.MAX_SAFE_INTEGER);return[o,a]}),t=n=>{if(Bl.includes(n))switch(n){case"markdownTotal":return d(Gr,{modelValue:e.modelValue},null);case"scrollSwitch":return d(Yr,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}else return e.defFooters instanceof Array?e.defFooters[n]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[n]||""};return()=>{const n=l.value[0].map(a=>t(a)),o=l.value[1].map(a=>t(a));return d("div",{class:`${s}-footer`},[d("div",{class:`${s}-footer-left`},[n]),d("div",{class:`${s}-footer-right`},[o])])}}}),et=V({name:"MdEditorV3",props:Za,emits:Ja,setup(e,l){const{editorId:t,noKatex:n,noMermaid:o,noPrettier:a,noUploadImg:c,noHighlight:f}=e,i=ee({scrollAuto:e.scrollAuto}),m=R(),r=R();Wa(e,l),Ua(e,m),za(e),Ga(e,l);const[u,g]=qa(e,l),h=Xa(e);return Ce(()=>{$.clear(t)}),Ka(e,l,h,u,g,r),()=>{const v=se({props:e,ctx:l},"defToolbars"),y=se({props:e,ctx:l},"defFooters");return d("div",{id:t,class:[s,e.class,e.theme==="dark"&&`${s}-dark`,u.fullscreen||u.pageFullscreen?`${s}-fullscreen`:""],style:e.style,ref:m},[e.toolbars.length>0&&d(vr,{noPrettier:a,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:u,updateSetting:g,tableShape:e.tableShape,defToolbars:v,noUploadImg:c,showToolbarName:e.showToolbarName,catalogVisible:h.value},null),d(zr,{ref:r,modelValue:e.modelValue,setting:u,mdHeadingId:e.mdHeadingId,noMermaid:o,noPrettier:a,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:n,scrollAuto:i.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:f,updateModelValue:p=>{l.emit("update:modelValue",p)},onChange:p=>{e.onChange&&e.onChange(p),l.emit("onChange",p)},onHtmlChanged:p=>{e.onHtmlChanged&&e.onHtmlChanged(p),l.emit("onHtmlChanged",p)},onGetCatalog:p=>{e.onGetCatalog&&e.onGetCatalog(p),l.emit("onGetCatalog",p)},onBlur:p=>{e.onBlur&&e.onBlur(p),l.emit("onBlur",p)},onFocus:p=>{e.onFocus&&e.onFocus(p),l.emit("onFocus",p)},onInput:p=>{e.onInput&&e.onInput(p),l.emit("onInput",p)},completions:e.completions,catalogVisible:h.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:p=>{e.onDrop&&e.onDrop(p),l.emit("onDrop",p)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:p=>{e.onInputBoxWitdhChange&&e.onInputBoxWitdhChange(p),l.emit("onInputBoxWitdhChange",p)},sanitizeMermaid:e.sanitizeMermaid,transformImgUrl:e.transformImgUrl,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold},null),e.footers.length>0&&d(Jr,{modelValue:e.modelValue,footers:e.footers,defFooters:y,scrollAuto:i.scrollAuto,onScrollAutoChange:p=>i.scrollAuto=p},null)])}}});et.install=e=>(e.component(et.name,et),e.use(De).use(Re).use(je).use(Ee).use(Be),e);export{et as E};
