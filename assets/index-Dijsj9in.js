const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TapCaptcha-B3JFUNy4.js","assets/element-plus-hr2Rsl-r.js","assets/@vue-Qh5bA5yX.js","assets/lodash-es-ByZL8CPd.js","assets/async-validator-DKvM95Vc.js","assets/@vueuse-D9VHCHPz.js","assets/@element-plus-ByXdi8SP.js","assets/@ctrl-r5W6hzzQ.js","assets/@sxzz-D9SI2xQl.js","assets/normalize-wheel-es-B6fDCfyv.js","assets/element-plus-Bpj9wFlE.css","assets/close-DH-pkuwG.js","assets/index-C62uD4Jy.js","assets/pinia-CZlXL543.js","assets/vue-demi-Dq6ymT-8.js","assets/@codemirror-DQuTFEwR.js","assets/@lezer-Dgxrf84R.js","assets/crelt-C8TCjufn.js","assets/style-mod-Bc2inJdb.js","assets/w3c-keyname-Vcq4gwWv.js","assets/vue-router-DWNhqtit.js","assets/vue-i18n-BUChJ_zg.js","assets/@intlify-xpMVIekN.js","assets/vue-BIAHEXVJ.js","assets/pinia-plugin-persistedstate-BQU3TZ4K.js","assets/destr-CVtkxrq9.js","assets/deep-pick-omit-CegYQlcN.js","assets/index-Dsq_Pcbj.css","assets/plugin-vueexport-helper-DlAUqK2U.js","assets/TapCaptcha-BZ-s8ZH3.css"])))=>i.map(i=>d[i]);
import{_ as O}from"./@codemirror-DQuTFEwR.js";import{b as W,e as j,f as z,g as H,h as J,i as G}from"./element-plus-hr2Rsl-r.js";import{_ as Q,a as X}from"./lock-CyWgj84b.js";import{_ as Y,a as Z}from"./index-CpJuUThA.js";import{d as ee,ao as b,K as oe,B as V,bK as L,E as ae,J as te,c as se,a as k,b as o,R as l,u as a,ah as ne,o as ie,V as re,W as le,aO as ce}from"./@vue-Qh5bA5yX.js";import{u as x,i as pe,p as n,r as E}from"./index-C62uD4Jy.js";import{_ as me}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./@lezer-Dgxrf84R.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./lodash-es-ByZL8CPd.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-D9VHCHPz.js";import"./@element-plus-ByXdi8SP.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-CZlXL543.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-DWNhqtit.js";import"./vue-i18n-BUChJ_zg.js";import"./@intlify-xpMVIekN.js";import"./vue-BIAHEXVJ.js";import"./pinia-plugin-persistedstate-BQU3TZ4K.js";import"./destr-CVtkxrq9.js";import"./deep-pick-omit-CegYQlcN.js";const de={class:"v100 flex ac"},ue={class:"qv-tool p-base w-base"},_e={class:"flex jc f1 pr no-event"},fe=ee({__name:"index",setup(ge){const{setLogout:I,userStaticData:B}=x(),C=ce(()=>O(()=>import("./TapCaptcha-B3JFUNy4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]))),{t:i}=pe.global,{setToken:S,setDynamicUser:T,userBaseData:D,showWelcome:R}=x(),m=b({loginLoading:!1}),t=b({username:"admin",password:"123456",keep:!1,captchaId:"",captchaInfo:""}),$=oe({username:[{required:!0,message:V(()=>i("login.请输入账号"))}],password:[{required:!0,message:V(()=>i("login.请输入密码"))}]}),q=L("ref_form"),F=L("ref_tap_captcha");let f,r,c;const u=async()=>{n.show(i("加载中..."));try{await T(!0),B.welcomeHasEnter=!0,D.id&&R()}catch(e){n.hide(),console.log(e)}},g=async(e="",s="")=>{n.show(i("login.登录中")),t.captchaInfo=e,t.captchaId=s;try{const{data:d}=await E("post",t);S(d.userInfo.token),await u()}catch{n.hide()}},h=async()=>{var e;f?(n.hide(),(e=F.value)==null||e.show()):await g()},w=async()=>{try{const{data:e}=await E("get");f=e.captcha,c&&await h(),r="success"}catch(e){e.code===303?(c&&n.hide(),!c&&window.app_entry.split("?redirectPath=")[0]==="/login"?(r=void 0,await u()):W.confirm(`${e.msg}${i("login.确认将继续登录, 取消将退出登录")}`,i("温馨提示")).then(async()=>{r=void 0,await u()}).catch(async()=>{r="fail",await I()})):(r="fail",n.hide()),c=!1}},y=async()=>{var e;m.loginLoading=!0;try{await((e=q.value)==null?void 0:e.validate()),r!=="success"?(c=!0,n.show(i("login.确认中")),r==="fail"&&await w()):await h()}catch{}m.loginLoading=!1};return ae(()=>{w()}),te(()=>{n.hide()}),(e,s)=>{const d=Y,U=Z,K=Q,v=z,_=H,M=X,P=J,N=G,A=j;return ie(),se("div",de,[k("div",ue,[o(d),o(U)]),k("div",_e,[o(A,{ref:"ref_form",rules:a($),model:a(t),class:"qv-form p-32",size:"large",onKeyup:ne(y,["enter"])},{default:l(()=>[o(_,{prop:"username"},{default:l(()=>[o(v,{modelValue:a(t).username,"onUpdate:modelValue":s[0]||(s[0]=p=>a(t).username=p),modelModifiers:{trim:!0},clearable:"",placeholder:e.$t("login.请输入账号"),maxlength:"30"},{prefix:l(()=>[o(K)]),_:1},8,["modelValue","placeholder"])]),_:1}),o(_,{prop:"password"},{default:l(()=>[o(v,{modelValue:a(t).password,"onUpdate:modelValue":s[1]||(s[1]=p=>a(t).password=p),modelModifiers:{trim:!0},type:"password",placeholder:e.$t("login.请输入密码"),"show-password":"",maxlength:"30"},{prefix:l(()=>[o(M)]),_:1},8,["modelValue","placeholder"])]),_:1}),o(P,{modelValue:a(t).keep,"onUpdate:modelValue":s[2]||(s[2]=p=>a(t).keep=p),label:e.$t("login.保持会话")},null,8,["modelValue","label"]),o(_,null,{default:l(()=>[o(N,{round:"",class:"w100",type:"primary","auto-insert-space":"",loading:a(m).loginLoading,onClick:y},{default:l(()=>[re(le(e.$t(a(m).loginLoading?"login.登录中":"login.登录")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])]),o(a(C),{ref:"ref_tap_captcha",onSucceed:g},null,512)])}}}),We=me(fe,[["__scopeId","data-v-3e4d0f0b"]]);export{We as default};
