import{u as E,H as I,t as M,v as N}from"./element-plus-rtZK4mjR.js";import{_ as q}from"./close-CHuxsR2e.js";import{d as D,al as L,o as s,J as x,K as r,G as C,u as a,b as $,P as y,c as n,a as F,s as H,S as b,Q as V,R as f,af as R,M as A,L as U,a1 as G,_ as J}from"./@vue-Bu2ox0Ej.js";import{i as K,g as P,d as Q,f as B,e as X}from"./index-BJH4a_tv.js";import{_ as Y}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./lodash-es-CbX0-HeL.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-BI9iYFro.js";import"./@element-plus-BaPZHkdt.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./@codemirror-C6X7y8Au.js";import"./pinia-BMu_gUya.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-Q6gHvPgm.js";import"./vue-i18n-BXMOD-z5.js";import"./@intlify-7FzvKZLA.js";import"./vue-CDKdorV-.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";const O=D({__name:"index",props:{showClose:{type:Boolean,default:!1}},emits:["closed"],setup(u,{expose:m,emit:g}){const w=u,d=g,i=L({isShow:!1});return m({hide:()=>{i.isShow=!1},show:()=>{i.isShow=!0}}),(_,o)=>{const k=q,v=E,e=I;return s(),x(e,{modelValue:a(i).isShow,"onUpdate:modelValue":o[1]||(o[1]=l=>a(i).isShow=l),draggable:"","align-center":"",class:"global-dialog","show-close":!1,onClosed:o[2]||(o[2]=l=>d("closed"))},{header:r(()=>[C(_.$slots,"header")]),footer:r(()=>[C(_.$slots,"footer")]),default:r(()=>[w.showClose?(s(),x(v,{key:0,underline:!1,class:"ani-rotate-icon",onClick:o[0]||(o[0]=l=>a(i).isShow=!1)},{default:r(()=>[$(k)]),_:1})):y("",!0),C(_.$slots,"default")]),_:3},8,["modelValue"])}}}),W={class:"icon-base",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Z=F("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1),tt=[Z];function et(u,m){return s(),n("svg",W,[...tt])}const ot={name:"ep-refresh",render:et},st={key:1,class:"flex ac jc"},at={class:"qv-box no-select p-r"},lt=["src"],nt=["onClick"],it=D({__name:"TapCaptcha",emits:["succeed"],setup(u,{expose:m,emit:g}){const w=g,{t:d}=K.global,i=H(),t=L({loading:!1,dots:[],tip:"",id:"",text:"",base64:""}),h=async()=>{if(!t.loading){t.loading=!0;try{const{data:e}=await P(Q("captcha"));t.dots=[],t.id=e.id,t.text=e.text,t.base64=e.base64}catch{}t.tip="",t.loading=!1}},_=()=>{var e;h(),(e=i.value)==null||e.show()};let o;const k=e=>{o=[...t.dots],o.splice(e,1),t.dots=o},v=async e=>{if(t.dots.length<t.text.length&&(o=[...t.dots],o.push(`${e.offsetX},${e.offsetY}`),t.dots=o,t.dots.length===t.text.length)){const l=[t.dots.join("-"),e.target.width,e.target.height].join(";");B.show(d("login.确认中"));try{await X(t.id,l),t.tip=d("login.验证成功"),w("succeed",l,t.id)}catch{t.tip=d("login.验证失败"),setTimeout(()=>{h()},500),B.hide()}}};return m({show:_}),(e,l)=>{const S=ot,T=M,j=O,z=N;return s(),x(j,{ref_key:"ref_dialog",ref:i},{header:r(()=>[a(t).tip?(s(),n(b,{key:0},[V(f(a(t).tip),1)],64)):a(t).text?(s(),n("div",st,[V(f(e.$t("login.请依次点击"))+" ",1),(s(!0),n(b,null,R(a(t).text,(c,p)=>(s(),n("span",{key:p,class:A(["qv-text ml-half fw-b",a(t).dots.length>p?"is-active":""])},f(c),3))),128)),$(T,{content:"刷新",placement:"top"},{default:r(()=>[$(S,{class:"ml-base c-p",onClick:h})]),_:1})])):y("",!0)]),default:r(()=>[U((s(),n("div",at,[a(t).base64?(s(),n("img",{key:0,class:"h-full",src:a(t).base64,alt:"加载中",onClick:l[0]||(l[0]=G(c=>v(c),["prevent"]))},null,8,lt)):y("",!0),(s(!0),n(b,null,R(a(t).dots,(c,p)=>(s(),n("div",{key:p,class:"qv-dot fw-b c-p flex ac jc",style:J(`left: ${parseFloat(c.split(",")[0])-10}px; top: ${parseFloat(c.split(",")[1])-10}px;`),onClick:rt=>k(p)},f(p+1),13,nt))),128))])),[[z,a(t).loading]])]),_:1},512)}}}),Rt=Y(it,[["__scopeId","data-v-4e21eaf0"]]);export{Rt as default};
