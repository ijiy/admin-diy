import{w as E,I as M,D as N,v as T}from"./element-plus-7Vlk8dbZ.js";import{_ as q}from"./close-DhbsgNMo.js";import{d as B,bp as I,o as s,K as C,L as c,H as x,u as a,b as $,Q as y,c as i,a as F,s as H,T as b,R as V,S as f,ag as D,O as A,M as U,a2 as K,$ as O}from"./@vue-BFtwODxB.js";import{i as Q,c as X,d as Y,f as R,e as G}from"./index-4vTwd3nK.js";import{_ as J}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./lodash-es-ByZL8CPd.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-DQwSfm13.js";import"./@element-plus-DHzED8UM.js";import"./@ctrl-r5W6hzzQ.js";import"./@sxzz-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-BdGwRZaI.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-i18n-v7gGpLht.js";import"./@intlify-7FzvKZLA.js";import"./vue-h5XNpCLg.js";import"./vue-router-BtlUgo1z.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";const P=B({__name:"index",props:{showClose:{type:Boolean,default:!1}},emits:["closed"],setup(u,{expose:_,emit:g}){const w=u,p=g,l=I({isShow:!1});return _({hide:()=>{l.isShow=!1},show:()=>{l.isShow=!0}}),(m,o)=>{const k=q,v=E,e=M;return s(),C(e,{modelValue:a(l).isShow,"onUpdate:modelValue":o[1]||(o[1]=n=>a(l).isShow=n),draggable:"","align-center":"",class:"global-dialog","show-close":!1,onClosed:o[2]||(o[2]=n=>p("closed"))},{header:c(()=>[x(m.$slots,"header")]),footer:c(()=>[x(m.$slots,"footer")]),default:c(()=>[w.showClose?(s(),C(v,{key:0,underline:!1,class:"ani-rotate-icon",onClick:o[0]||(o[0]=n=>a(l).isShow=!1)},{default:c(()=>[$(k)]),_:1})):y("",!0),x(m.$slots,"default")]),_:3},8,["modelValue"])}}}),W={class:"icon-base",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Z=F("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1),tt=[Z];function et(u,_){return s(),i("svg",W,[...tt])}const ot={name:"ep-refresh",render:et},st={key:1,class:"flex ac jc"},at={class:"qv-box no-select pr"},nt=["src"],it=["onClick"],lt=B({__name:"index",emits:["succeed"],setup(u,{expose:_,emit:g}){const w=g,{t:p}=Q.global,l=H(),t=I({loading:!1,dots:[],tip:"",id:"",text:"",base64:""}),h=async()=>{if(!t.loading){t.loading=!0;try{const{data:e}=await X(Y("captcha"));t.dots=[],t.id=e.id,t.text=e.text,t.base64=e.base64}catch{}t.tip="",t.loading=!1}},m=()=>{var e;h(),(e=l.value)==null||e.show()};let o;const k=e=>{o=[...t.dots],o.splice(e,1),t.dots=o},v=async e=>{if(t.dots.length<t.text.length&&(o=[...t.dots],o.push(`${e.offsetX},${e.offsetY}`),t.dots=o,t.dots.length===t.text.length)){const n=[t.dots.join("-"),e.target.width,e.target.height].join(";");R.show(p("login.确认中"));try{await G(t.id,n),t.tip=p("login.验证成功"),w("succeed",n,t.id)}catch{t.tip=p("login.验证失败"),setTimeout(()=>{h()},500),R.hide()}}};return _({show:m}),(e,n)=>{const S=ot,L=N,j=P,z=T;return s(),C(j,{ref_key:"ref_dialog",ref:l},{header:c(()=>[a(t).tip?(s(),i(b,{key:0},[V(f(a(t).tip),1)],64)):a(t).text?(s(),i("div",st,[V(f(e.$t("login.请依次点击"))+" ",1),(s(!0),i(b,null,D(a(t).text,(r,d)=>(s(),i("span",{key:d,class:A(["qv-text ml-half fw-b",a(t).dots.length>d?"is-active":""])},f(r),3))),128)),$(L,{content:"刷新",placement:"top"},{default:c(()=>[$(S,{class:"ml-base cp",onClick:h})]),_:1})])):y("",!0)]),default:c(()=>[U((s(),i("div",at,[a(t).base64?(s(),i("img",{key:0,class:"h100",src:a(t).base64,alt:"加载中",onClick:n[0]||(n[0]=K(r=>v(r),["prevent"]))},null,8,nt)):y("",!0),(s(!0),i(b,null,D(a(t).dots,(r,d)=>(s(),i("div",{key:d,class:"qv-dot fw-b cp flex ac jc",style:O(`left: ${parseFloat(r.split(",")[0])-10}px; top: ${parseFloat(r.split(",")[1])-10}px;`),onClick:ct=>k(d)},f(d+1),13,it))),128))])),[[z,a(t).loading]])]),_:1},512)}}}),Dt=J(lt,[["__scopeId","data-v-9337ce00"]]);export{Dt as default};
